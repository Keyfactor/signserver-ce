<project name="cli"  basedir="." xmlns:signserver="signserver">

    <!-- Set this to false if no prompting for requested CA, 
         and Web configuration should be made
    -->
    <property name="signserver.prompt" value="true"/>

    <property name="signserver.home" location=".."/>
    <property environment="env"/>

    <property file="${user.home}/${app.name}.properties"/>
    <property file="../${app.name}.properties"/>
    <!-- this sucks because we have a dependency with JBoss just for the jndi provider -->
    <property name="jboss.home" value="${env.JBOSS_HOME}"/>

    <property name="lib.dir" location="../lib"/>

    <path id="classpath">
         <!-- need to pickup jndi.properties and log4j.properties -->
        <pathelement path="../bin"/>
        <pathelement path="../tmp/bin/classes"/>
        <fileset dir="${lib.dir}" includes="*.jar"/>
        <fileset dir="${jboss.home}/client" includes="*.jar"/>
    </path>

	<target name="signserver:cli" depends="signserver:noprompt" description="Handy hook to run a command">
		<signserver:cli name="${cli.name}" arg="${cli.args}"/>
	</target>

    
    <!--
    ==============================================================================
        macro definitions
    ==============================================================================
    -->
    <macrodef name="cli" uri="signserver">
        <attribute name="name"/>
        <attribute name="arg"/>
        <sequential>
        <echo message="@{name} @{arg}"/>
        <java classname="se.primeKey.signserver.primekey.@{name}" classpathref="classpath">
            <arg line="@{arg}"/>
        </java>
        </sequential>
    </macrodef>

    <macrodef name="keytool" uri="signserver">
        <attribute name="arg"/>
        <sequential>
        <exec executable="keytool">
            <arg line="@{arg}"/>
        </exec>
        </sequential>
    </macrodef>

</project>