<!doctype html>

<html lang="en">

    <head>

        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1">

        <link rel="icon" href="_scroll_external/attachments/e415105eb31a/ssdocs">

        <!-- Primary Meta Tags -->
        <meta name="exp-export-timestamp" content="2024-10-09T09:35:54.686+0000">
        <meta name="exp-page-id" content="370999526">
        <meta name="exp-page-title" content="Setting up One-time Keys">
        <meta name="exp-page-version" content="2">
        <meta name="exp-page-scroll-page-id" content="c7085b208916580c111f4e3bcfe6bc23">
        <meta name="exp-page-created" content="2021-09-09T13:02:45.000+0000">
        <meta name="exp-page-last-modified" content="2024-04-02T16:29:13.495+0000">
        <meta name="exp-page-labels" content="dss-1769,signserveree">
        <meta name="exp-page-context-keys" content="">
        <meta name="exp-space-key" content="SSDOCS">
        <meta name="exp-space-title" content="SignServer Documentation">

        <!-- Additional Meta Tags -->
        <meta name="exp-document-id" content="371111034">
        <meta name="exp-document-title" content="SignServer Documentation">
        <meta name="exp-version-status" content="in-progress">
        <meta name="exp-version-id" content="8a3e757d15e64586aa644eaf0980f27a">
        <meta name="exp-version-name" content="Working version">
        <meta name="exp-version-description" content="">
        <meta name="exp-version-date" content="2024-02-17T13:18:25Z">
        <meta name="exp-variant-id" content="">
        <meta name="exp-variant-name" content="">
        <meta name="exp-variant-description" content="">
        <meta name="exp-language-code" content="">
        <meta name="exp-language-name" content="">

        <link rel="stylesheet" href="css/app.css">
        <link rel="stylesheet" href="css/image-dimensions.css">


            
            
<script src="js/search.js"></script>
            <script id="search-worker" type="javascript/worker">
    onmessage = function(event) {
        // dispatch events to handling functions
        var message = event.data;

        if ((message.type === 'setup') && message.baseUrl) {
            setup(message.baseUrl);
        }

        if (message.type === 'search-request') {
            search(message.query);
        }
    }

    var searchIndex;

    function setup(baseUrl) {
        importScripts(
            baseUrl + 'js/lunr.js',
            baseUrl + 'js/lunr-index.js',
            baseUrl + 'js/lunr-data.js'
        );
        try {
            // load lunr-extras if it exists, which contains language-specific files for languages other than english
            importScripts(baseUrl + 'js/lunr-extras.js');
        } catch (e) {}
        searchIndex = lunr.Index.load(lunrIndex);
    }

    function search(query) {
        var searchHits = searchIndex.search(query);
        var results = searchHits.map(function (result) {
            return lunrData.filter(function (d) {
                return d.id === result.ref;
            })[0]
        });
        postMessage({ type: 'search-results', results: results, query: query });
    }
</script>
        <title>Setting up One-time Keys</title>

    <meta name="generator" content="Scroll HTML Exporter / K15t GmbH"></head>

    <body id="SettingupOne-timeKeys-top" data-pageid="370999526" data-confluence-editor-version="v1" data-confluence-deployment-type="CLOUD">

        <div class="exp-grid-container">

            <header class="exp-header"></header>

            <div class="exp-logo">
                <a href="SignServer_Documentation.html">
                    <span class="exp-logo-image" style="background-image: url(_scroll_external/attachments/e415105eb31a/ssdocs)" alt="SignServer Documentation" title="SignServer Documentation"></span>
                </a>
            </div>

            <div class="exp-document-title">
                <h1 class="exp-document-title-heading scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h1 scroll-relative-h1" data-scroll-heading-rank="1" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="1" id="no-src_generated-id-cfa0c9f1f7737c1eca52af381e3790b02ef3137c1a5bd8a4ac4a6578ce04c108">
                    <a href="SignServer_Documentation.html">
                        SignServer Documentation
                    </a>
                </h1>
            </div>

<div class="exp-search-container">
    <input type="search" id="search-textbox" autocomplete="off" class="exp-search-input" style="margin-right: 0;">
    <div class="exp-search-input-icon">
        <svg data-exp-id="magnifier-icon" data-exp-component="icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewbox="0 0 20 20" fill="none" aria-hidden="true">
            <path d="M8.99452 14.5C10.5121 14.5 11.809 13.9669 12.8854 12.9007C13.9618 11.8345 14.5 10.5361 14.5 9.00548C14.5 7.48794 13.9631 6.19097 12.8893 5.11458C11.8155 4.03819 10.519 3.5 9 3.5C7.46786 3.5 6.16816 4.0369 5.1009 5.11071C4.03363 6.18453 3.5 7.48096 3.5 9C3.5 10.5321 4.0331 11.8318 5.09929 12.8991C6.1655 13.9664 7.46391 14.5 8.99452 14.5ZM9 16C8.02913 16 7.11974 15.816 6.27185 15.4479C5.42395 15.0799 4.68056 14.5799 4.04167 13.9479C3.40278 13.316 2.90278 12.576 2.54167 11.728C2.18056 10.88 2 9.97053 2 8.99956C2 8.04152 2.18403 7.13542 2.55208 6.28125C2.92014 5.42708 3.41864 4.68387 4.04758 4.0516C4.67653 3.41935 5.41569 2.91935 6.26508 2.5516C7.11449 2.18387 8.02548 2 8.99806 2C9.95769 2 10.8646 2.18403 11.7188 2.55208C12.5729 2.92014 13.316 3.42014 13.9479 4.05208C14.5799 4.68403 15.0799 5.42612 15.4479 6.27835C15.816 7.13058 16 8.0381 16 9.00094C16 9.83365 15.8615 10.6213 15.5846 11.3638C15.3078 12.1062 14.9254 12.7836 14.4375 13.3958L18 16.9583L16.9375 18L13.375 14.4583C12.7668 14.9459 12.0939 15.3247 11.3564 15.5948C10.6188 15.8649 9.83333 16 9 16Z" fill="currentColor" />
        </svg>
    </div>
    <div id="search-suggestion-container" class="exp-search-suggestion-panel" data-exp-component="search-suggestion"></div>
    <template id="exp-search-suggestion-option-template">
        <div class="exp-search-suggestion-option-container search-form-suggestion">
            <a class="exp-search-suggestion-option search-form-suggestion" href=""></a>
        </div>
    </template>
</div>


            <nav class="exp-sidebar-navigation">
                <div class="exp-sidebar-navigation-sticky-wrapper">
                    <iframe src="toc.html?pageId=370999526" border="0"></iframe>
                </div>

            </nav>


            <nav aria-label="Breadcrumb" class="exp-breadcrumbs-wrapper">
                <ol class="breadcrumbs">
                        <li class="breadcrumb">
                            <a href="SignServer_Documentation.html" rel="prev" target="_self">SignServer Documentation</a>
                        </li>
                        <li class="breadcrumb">
                            <a href="SignServer_Operations.html" rel="prev" target="_self">SignServer Operations</a>
                        </li>
                    <li class="breadcrumb active" aria-current="page">
                        Setting up One-time Keys
                    </li>
                </ol>
            </nav>


            <main class="exp-content">
                <article role="article">

                    <header>
                        <h1 class="article-heading scroll-h1 scroll-original-h1 scroll-relative-h1 scroll-custom-section-heading scroll-document-section-heading" role="heading" data-scroll-heading-rank="1" data-scroll-original-heading-rank="1" data-scroll-relative-heading-rank="1" id="no-src_generated-id-94fbfbe5875d8427ab3d96abd6d610cddab8329a62d36ea298e3d25c7e4945d3">
                            Setting up One-time Keys
                        </h1>
                    </header>

                    <section class="page" id="content" role="main">
                        <div id="main-content" class="wiki-content article-content js-tocBot-content">
                            <p><style>[data-colorid=k04ek5k25c]{color:#0e101a} html[data-color-mode=dark] [data-colorid=k04ek5k25c]{color:#e5e7f1}[data-colorid=nkqeicxqhd]{color:#0e101a} html[data-color-mode=dark] [data-colorid=nkqeicxqhd]{color:#e5e7f1}[data-colorid=fzpib1u4ik]{color:#0e101a} html[data-color-mode=dark] [data-colorid=fzpib1u4ik]{color:#e5e7f1}</style><span style="color: rgb(0,0,0);"><span class="status-macro aui-lozenge aui-lozenge-complete">enterprise</span></span></p><p>One-time keys and certificates allow you to have a large number of individual signing keys and certificates, despite the often limited storage capabilities of HSMs. One-time keys are created on request and are deleted once the signature has been created.</p><p class="inline-comment-marker">One-time keys use a specific <span class="confluence-link">crypto worker</span> called <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a>. The crypto worker references a regular crypto token used to generate the short-lived key-pair. Every time a signer requests a crypto instance from the <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a>, a new key-pair is generated and a certificate for the public key is obtained from a CA Connector component.</p><p>SignServer allows multiple implementations of the CA component. The following describes how to set up one-time keys either using the&nbsp;<a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-Self-SignedCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-Self-SignedCAConnector" data-scroll-link-target-source-id="370999526">Self-Signed CA Connector</a> for testing purposes or using the <a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-EJBCAPeersCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-EJBCAPeersCAConnector" data-scroll-link-target-source-id="370999526">EJBCA Peers CA Connector</a> or the <a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-EJBCAWSCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-EJBCAWSCAConnector" data-scroll-link-target-source-id="370999526">EJBCA WS CA Connector</a> to connect to the <a class="external-link scroll-external-link" href="https://doc.primekey.com/ejbca" rel="nofollow" shape="rect" data-scroll-link-type="default" data-scroll-link-target="https://doc.primekey.com/ejbca" data-scroll-link-local="false">EJBCA</a>.</p><p></p><h2 id="SettingupOne-timeKeys-Step1:SetUpCryptoWorkerwithSourceCryptoToken" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Step 1:&nbsp;Set Up Crypto Worker with Source Crypto Token&nbsp;</h2><p>Make sure you have a <a href="CryptoWorker.html" data-linked-resource-id="371000074" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000074" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000074/CryptoWorker" data-scroll-link-target-source-id="371000074">CryptoWorker</a> with a source <a href="PKCS11CryptoToken.html" data-linked-resource-id="371000127" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000127" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000127/PKCS11CryptoToken" data-scroll-link-target-source-id="371000127">PKCS11CryptoToken</a> set up.</p><p>The following shows&nbsp;a source crypto worker <strong>CryptoTokenP11</strong> sample configuration&nbsp;<strong>pkcs11-crypto.properties</strong>:</p><div class="scroll-code scroll-highlighted-code-block" data-title="Sample source crypto worker configuration" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="title">Sample source crypto worker configuration</div><div class="defaultnew content" data-title="Sample source crypto worker configuration">
<div class="line"><code class="plain">WORKERGENID1.TYPE=CRYPTO_WORKER</code></div>
<div class="line"><code class="plain">WORKERGENID1.IMPLEMENTATION_CLASS=org.signserver.server.signers.CryptoWorker</code></div>
<div class="line"><code class="plain">WORKERGENID1.CRYPTOTOKEN_IMPLEMENTATION_CLASS=org.signserver.server.cryptotokens.PKCS11CryptoToken</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Name </code><code class="keyword">for</code><code class="plain"> other workers to reference </code><code class="keyword">this</code><code class="plain"> worker:</code></div>
<div class="line"><code class="plain">WORKERGENID1.NAME=CryptoTokenP11</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Name of the PKCS#</code><code class="value">11</code><code class="plain"> shared library to use: </code></div>
<div class="line"><code class="plain">WORKERGENID1.SHAREDLIBRARYNAME=Utimaco</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># HSM slot details</code></div>
<div class="line"><code class="plain">WORKERGENID1.SLOTLABELTYPE=SLOT_NUMBER</code></div>
<div class="line"><code class="plain">WORKERGENID1.SLOTLABELVALUE=</code><code class="value">1</code></div>
<div class="line"><code class="plain">WORKERGENID1.PIN=foo123</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">#One key to test activation with is required. If </code><code class="keyword">this</code><code class="plain"> key does not already exist generate it after the worker has been created.</code></div>
<div class="line"><code class="plain">WORKERGENID1.DEFAULTKEY=testkey0</code></div>
</div>
</div><h2 id="SettingupOne-timeKeys-Step2:SetUpOne-timeCryptoWorkerReferencingtheSourceCryptoWorker" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Step 2: Set Up One-time Crypto Worker Referencing the Source Crypto Worker</h2><p>Next, set up a OneTimeCryptoWorker referencing the source CryptoWorker. You can choose to test the OneTimeCryptoWorker without an actual CA by setting up the <a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-Self-signedCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-Self-signedCAConnector" data-scroll-link-target-source-id="370999526">Self-signed CA Connector</a> that generates its own self-signed certificate, using the <a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-EJBCAPeersCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-EJBCAPeersCAConnector" data-scroll-link-target-source-id="370999526">EJBCA Peers CA Connector</a> that uses EJBCA Peer Systems to request certificates from EJBCA, or <a href="Setting_up_One-time_Keys.html#SettingupOne-timeKeys-EJBCAWSCAConnector" data-scroll-target-source-id="370999526" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999526/Setting+up+One-time+Keys#src-370999526_SettingupOne-timeKeys-EJBCAWSCAConnector" data-scroll-link-target-source-id="370999526">EJBCA WS CA Connector</a> that connects to EJBCA using Web Services.</p><h3 id="SettingupOne-timeKeys-Self-SignedCAConnector" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Self-Signed CA Connector</h3><p>The Self-Signed CA Connector generates its own self-signed certificate and is suitable for testing the OneTimeCryptoWorker without requiring a real CA.</p><p>To configure the Self-Signed CA Connector and set up a crypto worker referencing the source crypto worker, do the following:</p><ol><li><p>Add a new worker using the template <strong>onetime-crypto.properties</strong>. See <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a> properties for details.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Value</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>NAME</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Update as appropriate, for example P11 or P12 and possibly slot.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CACONNECTOR_IMPLEMENTATION</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>org.signserver.module.onetime.caconnector.SelfSignedCAConnector</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><pre>CERTSIGNATUREALGORITHM</pre></td><td colspan="1" rowspan="1" class="confluenceTd"><pre>SHA256WithRSA</pre></td></tr></tbody></table></div><p><strong>Example Configuration Sample</strong><br clear="none">The following shows a sample configuration <strong>onetime-crypto.properties</strong> for a crypto worker <strong>CryptoTokenP11OneTimeSelfSigned</strong>:</p><div class="scroll-code scroll-highlighted-code-block" data-title="Sample Configuration" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="title">Sample Configuration</div><div class="defaultnew content" data-title="Sample Configuration">
<div class="line"><code class="plain">WORKERGENID1.TYPE=CRYPTO_WORKER</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">WORKERGENID1.IMPLEMENTATION_CLASS=org.signserver.module.onetime.cryptoworker.OneTimeCryptoWorker</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># Name </code><code class="keyword">for</code><code class="plain"> other workers to reference </code><code class="keyword">this</code><code class="plain"> worker:</code></div>
<div class="line"><code class="plain">WORKERGENID1.NAME=CryptoTokenP11OneTimeSelfSigned</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># References a source CryptoToken</code></div>
<div class="line"><code class="plain">WORKERGENID1.CRYPTOTOKEN=CryptoTokenP11</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># Key generation</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYALG=RSA</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYSPEC=</code><code class="value">2048</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># CA Connector: Self-signed demo connector (not using a real CA)</code></div>
<div class="line"><code class="plain">WORKERGENID1.CACONNECTOR_IMPLEMENTATION=org.signserver.module.onetime.caconnector.SelfSignedCAConnector</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># CSR &amp; Certificate Signing</code></div>
<div class="line"><code class="plain">WORKERGENID1.CERTSIGNATUREALGORITHM=SHA256WithRSA</code></div>
</div>
</div></li><li><p>Check that the status of the worker is ACTIVE, either on the SignServer Admin Web <strong>Worker Status</strong> page, or in the CLI using the command: <code>./bin/signserver getstatus brief</code>.</p></li></ol><h3 id="SettingupOne-timeKeys-EJBCAPeersCAConnector" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">EJBCA Peers CA Connector</h3><p>The EJBCA Peers Connector uses <a class="external-link scroll-external-link" href="https://doc.primekey.com/ejbca/ejbca-operations/ejbca-ca-concept-guide/peer-systems" rel="nofollow" shape="rect" data-scroll-link-type="default" data-scroll-link-target="https://doc.primekey.com/ejbca/ejbca-operations/ejbca-ca-concept-guide/peer-systems" data-scroll-link-local="false">EJBCA Peer Systems</a> to request certificates from an EJBCA instance.</p><p>To configure the EJBCA Peers CA Connector and set up a crypto worker referencing the source crypto worker, do the following:</p><ol><li><p class="auto-cursor-target">Add a new <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a> using the template <strong>onetime-crypto.properties </strong>and make the following changes. See <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a> properties for details.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Value</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>NAME</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Update as appropriate, for example, P11 or P12, and possibly slot.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CACONNECTOR_IMPLEMENTATION</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Enable the following by removing the comments for the EjbcaWSCAConnector properties:<br clear="none"></p><ul><li>CACONNECTOR_IMPLEMENTATION=org.signserver.module.onetime.caconnector.EjbcaPeersCAConnector</li><li>CANAME</li><li>ENDENTITYPROFILE</li><li>CERTIFICATEPROFILE</li><li>USERNAME_PATTERN</li><li>SUBJECTDN_PATTERN</li><li>SUBJECTALTNAME_PATTERN</li><li>CERTIFICATESTARTTIME</li><li>CERTIFICATEENDTIME</li></ul><p></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CERTSIGNATUREALGORITHM</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>SHA256WithRSA</p></td></tr></tbody></table></div><p class="auto-cursor-target"><strong>Example Configuration</strong></p><p class="auto-cursor-target">The following shows a sample configuration onetime-crypto.properties for a crypto worker <strong>CryptoTokenP11OneTimeEjbcaPeers:</strong></p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">WORKERGENID1.TYPE=CRYPTO_WORKER</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">WORKERGENID1.IMPLEMENTATION_CLASS=org.signserver.module.onetime.cryptoworker.OneTimeCryptoWorker</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Name </code><code class="keyword">for</code><code class="plain"> other workers to reference </code><code class="keyword">this</code><code class="plain"> worker:</code></div>
<div class="line"><code class="plain">WORKERGENID1.NAME=CryptoTokenP11OneTimeEjbcaPeers</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># References a source CryptoToken</code></div>
<div class="line"><code class="plain">WORKERGENID1.CRYPTOTOKEN=CryptoTokenP11</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Key generation</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYALG=RSA</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYSPEC=</code><code class="value">2048</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># CA Connector: EjbcaPeers (using EJBCA through Peer Connections)</code></div>
<div class="line"><code class="plain">WORKERGENID1.CACONNECTOR_IMPLEMENTATION=org.signserver.module.onetime.caconnector.EjbcaPeersCAConnector</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">WORKERGENID1.ENDENTITYPROFILE=EMPTY</code></div>
<div class="line"><code class="plain">WORKERGENID1.CERTIFICATEPROFILE=ENDUSER</code></div>
<div class="line"><code class="plain">WORKERGENID1.USERNAME_PATTERN=onetime-${transactionId}</code></div>
<div class="line"><code class="plain">WORKERGENID1.SUBJECTDN_PATTERN=CN=User ${username},UID=${transactionId},O=SignServer Testing,C=SE </code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># CSR &amp; Certificate Signing</code></div>
<div class="line"><code class="plain">WORKERGENID1.CERTSIGNATUREALGORITHM=SHA256WithRSA</code></div>
</div>
</div></li><li>Setup an EJBCA Peer connection as described in <a href="Peer_Systems.html" data-linked-resource-id="371000778" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000778" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000778/Peer+Systems" data-scroll-link-target-source-id="371000778">Peer Systems</a> <span data-colorid="nkqeicxqhd">and also ensure to enable the <strong>Process incoming requests</strong> option for the Peer Connector in EJBCA (<strong>EJBCA Admin Web&gt;</strong></span><strong><span data-colorid="fzpib1u4ik">Peer Systems</span></strong><span data-colorid="k04ek5k25c">), see EJBCA documentation on <a class="external-link scroll-external-link" href="https://doc.primekey.com/ejbca/ejbca-operations/ejbca-operations-guide/ca-operations-guide/peer-systems-operations/adding-an-outgoing-peer-connection" rel="nofollow" shape="rect" data-scroll-link-type="default" data-scroll-link-target="https://doc.primekey.com/ejbca/ejbca-operations/ejbca-operations-guide/ca-operations-guide/peer-systems-operations/adding-an-outgoing-peer-connection" data-scroll-link-local="false">Adding an Outgoing Peer Connection</a></span>.</li><li>Check that the status of the worker is ACTIVE, either on the SignServer Admin Web <strong>Worker Status</strong> page, or in the CLI using the command: <code>./bin/signserver getstatus brief</code>.</li></ol><h3 id="SettingupOne-timeKeys-EJBCAWSCAConnector" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">EJBCA WS CA Connector</h3><p>The EJBCA WS CA Connector connects to EJBCA using Web Services.</p><p>To configure the EJBCA WS CA Connector and set up a crypto worker referencing the source crypto worker, do the following:</p><ol><li><p>Add a new worker using the template <strong>onetime-crypto.properties</strong> and make the following changes. See <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a> properties for details.</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Value</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>NAME</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Update as appropriate, for example, P11 or P12, and possibly slot.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CACONNECTOR_IMPLEMENTATION</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Enable the following by removing the comments for the EjbcaWSCAConnector properties:<br clear="none"></p><ul><li>CACONNECTOR_IMPLEMENTATION=org.signserver.module.onetime.caconnector.EjbcaWSCAConnector</li><li>TRUSTSTORETYPE</li><li>TRUSTSTOREPATH or TRUSTSTOREVALUE (depending on TRUSTSTORETYPE)</li><li>TRUSTSTOREPASSWORD</li><li>TLSCLIENTKEY</li><li>EJBCAWSURL</li><li>CANAME</li><li>ENDENTITYPROFILE</li><li>CERTIFICATEPROFILE</li><li>USERNAME_PATTERN</li><li>SUBJECTDN_PATTERN</li><li>SUBJECTALTNAME_PATTERN</li><li>CERTIFICATESTARTTIME</li><li>CERTIFICATEENDTIME</li></ul><p></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CERTSIGNATUREALGORITHM</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>SHA256WithRSA</p></td></tr></tbody></table></div><p><strong><strong>Example Configuration Sample</strong><br clear="none"></strong></p><p>The following shows a sample configuration <strong>onetime-crypto.properties</strong> for a crypto worker <strong>CryptoTokenP11OneTimeEjbcaWS</strong>:</p><div class="scroll-code scroll-highlighted-code-block" data-title="Sample CryptoTokenP11OneTimeEjbcaWS Configuration" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="title">Sample CryptoTokenP11OneTimeEjbcaWS Configuration</div><div class="defaultnew content" data-title="Sample CryptoTokenP11OneTimeEjbcaWS Configuration">
<div class="line"><code class="plain">WORKERGENID1.TYPE=CRYPTO_WORKER</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">WORKERGENID1.IMPLEMENTATION_CLASS=org.signserver.module.onetime.cryptoworker.OneTimeCryptoWorker</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Name </code><code class="keyword">for</code><code class="plain"> other workers to reference </code><code class="keyword">this</code><code class="plain"> worker:</code></div>
<div class="line"><code class="plain">WORKERGENID1.NAME=CryptoTokenP11OneTimeEjbcaWS</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># References a source CryptoToken</code></div>
<div class="line"><code class="plain">WORKERGENID1.CRYPTOTOKEN=CryptoTokenP11</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Key generation</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYALG=RSA</code></div>
<div class="line"><code class="plain">WORKERGENID1.KEYSPEC=</code><code class="value">2048</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># CA Connector: EjbcaWS (using EJBCA through Web Services)</code></div>
<div class="line"><code class="plain">WORKERGENID1.CACONNECTOR_IMPLEMENTATION=org.signserver.module.onetime.caconnector.EjbcaWSCAConnector</code></div>
<div class="line"><code class="plain">WORKERGENID1.TRUSTSTORETYPE=JKS</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># To trust the TLS certificate of the CA the trust store properties must be configured and contain the issuer (i.e. CA) certificate that issued the TLS server certificate used when connecting to the CA</code></div>
<div class="line"><code class="plain">WORKERGENID1.TRUSTSTOREPATH=/opt/jboss-eap-</code><code class="value">6.4</code><code class="plain">-ca/standalone/configuration/keystore/truststore.jks</code></div>
<div class="line"><code class="plain">WORKERGENID1.TRUSTSTOREPASSWORD=changeit</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">WORKERGENID1.TLSCLIENTKEY=tls_key</code></div>
<div class="line"><code class="plain">WORKERGENID1.EJBCAWSURL=https:</code><code class="comments">//localhost:9443/ejbca</code></div>
<div class="line"><code class="plain">WORKERGENID1.ENDENTITYPROFILE=EMPTY</code></div>
<div class="line"><code class="plain">WORKERGENID1.CERTIFICATEPROFILE=ENDUSER</code></div>
<div class="line"><code class="plain">WORKERGENID1.USERNAME_PATTERN=onetime-${transactionId}</code></div>
<div class="line"><code class="plain">WORKERGENID1.SUBJECTDN_PATTERN=CN=User ${username},UID=${transactionId},O=SignServer Testing,C=SE </code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># CSR &amp; Certificate Signing</code></div>
<div class="line"><code class="plain">WORKERGENID1.CERTSIGNATUREALGORITHM=SHA256WithRSA</code></div>
</div>
</div></li><li><p>To trust the TLS certificate of the CA, the truststore properties must be configured and contain the issuer (i.e. CA) certificate that issued the TLS server certificate used when connecting to the CA. In some cases you can just point out the path to the <code>truststore.jks</code> from the application server where EJBCA is running.</p></li><li>Create a TLS client key (<strong>tls_key</strong>).</li><li>Generate a Certificate Signing Request (CSR) for the TLS key created in the step above, get the certificate for the CSR, and install the certificate for the key in the token.</li><li>Provide Administrator access for the TLS Client certificate under the EJBCA CA Administration section, to enable the TLS client to access the CA resource (Web Service).</li><li><p>Check that the status of the worker is ACTIVE, either on the SignServer Admin Web <strong>Worker Status</strong> page, or in the CLI using the command: <code>./bin/signserver getstatus brief</code>.</p></li></ol><p></p><h2 id="SettingupOne-timeKeys-Step3:SetUpSignerwithOne-timeKey" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Step 3: Set Up Signer with One-time Key</h2><p>Configure a signer (for example the XAdESSigner) to use the following properties of your newly created CryptoWorker.</p><p>Since the user credentials are used in the certificate issuance, the signer needs to use a username or username/password authorizer, see <a href="OneTimeCryptoWorker.html" data-linked-resource-id="371000102" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000102" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000102/OneTimeCryptoWorker" data-scroll-link-target-source-id="371000102">OneTimeCryptoWorker</a>.</p><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 50.4302%;"><colgroup span="1"><col span="1" style="width: 26.2025%;"></colgroup><colgroup span="1"><col span="1" style="width: 73.827%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Change</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CRYPTOTOKEN</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>CryptoTokenP11OneTimeSelfSigned <br clear="none">or<br clear="none">CryptoTokenP11OneTimeEjbcaWS</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>AUTHTYPE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>org.signserver.server.UsernameAuthorizer</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCEPT_ALL_USERNAMES</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>true</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ALIASSELECTOR</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>org.signserver.server.aliasselectors.AuthorizedUsernameAliasSelector</p></td></tr></tbody></table></div><p><strong>Example Configuration Sample<br clear="none"></strong></p><p>The following shows a sample configuration <strong>xadessigner.properties</strong> for a <strong>CryptoTokenP11OneTimeEjbcaWS</strong>:</p><div class="scroll-code scroll-highlighted-code-block" data-title="Sample XAdESSigner Configuration with One-time Key" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="title">Sample XAdESSigner Configuration with One-time Key</div><div class="defaultnew content" data-title="Sample XAdESSigner Configuration with One-time Key">
<div class="line"><code class="plain"># General properties</code></div>
<div class="line"><code class="plain">WORKERGENID1.TYPE=PROCESSABLE</code></div>
<div class="line"><code class="plain">WORKERGENID1.IMPLEMENTATION_CLASS=org.signserver.module.xades.signer.XAdESSigner</code></div>
<div class="line"><code class="plain">WORKERGENID1.NAME=XAdESSigner</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># Crypto token</code></div>
<div class="line"><code class="plain">WORKERGENID1.CRYPTOTOKEN=CryptoTokenP11OneTimeEjbcaWS</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain"># Using one key-pair in the above crypto token</code></div>
<div class="line"><code class="plain">WORKERGENID1.DEFAULTKEY=tls_key</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain"># Properties related to User Authentication &amp; Alias selector as username will be part of Subject DN and Alias selector will be used to select key alias based on logged user name.</code></div>
<div class="line"><code class="plain">WORKERGENID1.AUTHTYPE=org.signserver.server.UsernameAuthorizer</code></div>
<div class="line"><code class="plain">WORKERGENID1.ACCEPT_ALL_USERNAMES=</code><code class="keyword">true</code></div>
<div class="line"><code class="plain">WORKERGENID1.ALIASSELECTOR=org.signserver.server.aliasselectors.AuthorizedUsernameAliasSelector</code></div>
<div class="line"><code class="plain"> </code></div>
<div class="line"><code class="plain">WORKERGENID1.SIGNATUREALGORITHM=SHA256withRSA</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">WORKERGENID1.XADESFORM = BES</code></div>
<div class="line"><code class="plain">WORKERGENID1.INCLUDE_CERTIFICATE_LEVELS=</code><code class="value">1</code></div>
<div class="line"><code class="plain">WORKERGENID1.COMMITMENT_TYPES = NONE</code></div>
</div>
</div><h2 id="SettingupOne-timeKeys-Step4:TestandVerifySigningwithOne-timeKeys" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-original-h2 scroll-custom-section-heading scroll-document-section-heading scroll-h2 scroll-relative-h2">Step 4: Test and Verify Signing with One-time Keys</h2><p>You can now test to sign using SignClient or test the performance using the stresstest tool.</p><h3 id="SettingupOne-timeKeys-TestSigningwithSignClient" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Test Signing with SignClient</h3><p>To test signing using the SignServer CLI SignClient, run the following:</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">bin/signclient signdocument -workername XAdESSigner -data </code><code class="string">"&lt;xml/&gt;"</code><code class="plain"> -username user1 -password password</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">bin/signclient signdocument -workername CMSSigner -infile </code><code class="string">"input.txt"</code><code class="plain"> -username user1 -password password -outfile </code><code class="string">"output.p7s"</code></div>
<div class="line">&nbsp;</div>
<div class="line"><code class="plain">bin/signclient signdocument -workername JArchiveSigner -infile </code><code class="string">"HelloJar.jar"</code><code class="plain"> -username user1 -password password -outfile </code><code class="string">"HelloSignedJar.jar"</code></div>
</div>
</div><p>Note that a new certificate with a new key is used every time.</p><h3 id="SettingupOne-timeKeys-SignatureVerification" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Signature Verification</h3><ul><li><p class="auto-cursor-target">To verify the CMS Signature through OpenSSL, run the following:</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">openssl cms -verify -in output.p7s -inform DER -content input.txt -CAfile cacert.pem &gt; /dev/</code><code class="keyword">null</code></div>
</div>
</div></li></ul><ul><li><p class="auto-cursor-target">To verify the code signature with jarsigner, run the following:</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">jarsigner -verify -strict HelloJar_Signed.jar -certs </code></div>
</div>
</div></li></ul><h3 id="SettingupOne-timeKeys-PerformanceTestusingStresstestTool" data-scroll-heading-rank-offset="1" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-original-h3 scroll-custom-section-heading scroll-document-section-heading scroll-h3 scroll-relative-h3">Performance Test using Stresstest Tool</h3><p>To run a performance test using the stresstest tool, run the following:</p><div class="scroll-code scroll-highlighted-code-block" data-title-type="code" data-theme="defaultnew" style="  counter-reset: scroll-code-numbering 0;"><div class="defaultnew content">
<div class="line"><code class="plain">bin/stresstest -testsuite DocumentSigner1 -threads </code><code class="value">20</code><code class="plain"> -processurl http:</code><code class="comments">//localhost:8080/signserver/process -worker XAdESSigner -data "&lt;root/&gt;" -userprefix user -usersuffixmin 1 -usersuffixmax 500</code></div>
</div>
</div><div class="confluence-information-macro confluence-information-macro-warning"><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>To prevent memory leaks when generating a high number of keys, do not enable the crypto token caching (cryptotoken.keystorecache) in <code>conf/cesecore.properties.</code></p></div></div><p>For more information on using the stresstest tool, see <a href="Stresstest_CLI.html" data-linked-resource-id="370999677" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="370999677" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/370999677/Stresstest+CLI" data-scroll-link-target-source-id="370999677">Stresstest CLI</a>.</p>
                        </div>
                    </section>

                </article>
            </main>


                <nav class="exp-post-navigation-prev">
                    <a href="Setting_up_Key_Wrapping.html" class="post-navigation-link">
                        <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg">
                            <g id="ht-icon-prev">
                                <path fill="currentColor" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) " />
                            </g>
                        </svg>
                        <span>Setting up Key Wrapping</span>
                    </a>
                </nav>

                <nav class="exp-post-navigation-next">

                    <a href="Setting_up_OpenPGP_Signer.html" class="post-navigation-link">
                        <span>Setting up OpenPGP Signer</span>
                        <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg">
                            <g id="ht-icon-next">
                                <path fill="currentColor" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) " />
                            </g>
                        </svg>
                    </a>

                </nav>


            <nav class="exp-sidebar-toc js-tocBot">
                <!-- content generated by toc.js  -->
            </nav>

            <div class="exp-sidebar-navigation-toggle">
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
                <div class="exp-sidebar-navigation-toggle-icon-line"></div>
            </div>

            <div class="exp-scroll-to-top-container">
                <a href="#SettingupOne-timeKeys-top" class="exp-scroll-to-top-link">â†‘ Back to top</a>
            </div>

        </div>



<dialog class="exp-lightbox-container" aria-modal="true">
    <div class="lightbox-toolbar">
        <button type="button" class="exp-lightbox-close">
            <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 -960 960 960" aria-hidden="true">
                <path fill="currentColor" d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
            </svg>
        </button>
    </div>
    <div class="lightbox-content content">
    </div>
</dialog>

<template id="exp-lightbox-wrapper-template">
    <div class="exp-lightbox-wrapper">
        <div class="exp-lightbox-toggle">
            <button type="button" class="exp-lightbox-close">
                <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 -960 960 960" aria-hidden="true">
                    <path fill="currentColor" d="M120-120v-320h80v184l504-504H520v-80h320v320h-80v-184L256-200h184v80H120Z" />
                </svg>
            </button>
        </div>
    </div>
</template>

        <script src="js/tocbot.min.js"></script>
        <script src="js/article-toc.js"></script>
        <script src="js/app.js"></script>
        <script src="js/mobile.js"></script>
        <script src="js/iframe-resizer.parent.js"></script>

    </body>

</html>