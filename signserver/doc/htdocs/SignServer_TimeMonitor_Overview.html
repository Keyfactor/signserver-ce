<!doctype html>

<html class="no-js" lang="en" data-vp-page-id="371000358">


    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="_scroll_external/attachments/e415105eb31a/ssdocs">

    <!-- Primary Meta Tags -->
    <meta name="exp-export-timestamp" content="2024-11-07T13:05:32.756+0000">
    <meta name="exp-page-id" content="371000358">
    <meta name="exp-page-title" content="SignServer TimeMonitor Overview">
    <meta name="exp-page-version" content="3">
    <meta name="exp-page-scroll-page-id" content="c5bfd0c460e61de9ace1dd668e178f14">
    <meta name="exp-page-created" content="2022-11-09T07:34:38.000+0000">
    <meta name="exp-page-last-modified" content="2024-04-04T09:30:56.058+0000">
    <meta name="exp-page-labels" content="">
    <meta name="exp-page-context-keys" content="">
    <meta name="exp-space-key" content="SSDOCS">
    <meta name="exp-space-title" content="SignServer Documentation">

    <!-- Additional Meta Tags -->
    <meta name="exp-document-id" content="371111034">
    <meta name="exp-document-title" content="SignServer Documentation">
    <meta name="exp-version-status" content="in-progress">
    <meta name="exp-version-id" content="8a3e757d15e64586aa644eaf0980f27a">
    <meta name="exp-version-name" content="Working version">
    <meta name="exp-version-description" content="">
    <meta name="exp-version-date" content="2024-02-17T13:18:25Z">
    <meta name="exp-variant-id" content="">
    <meta name="exp-variant-name" content="">
    <meta name="exp-variant-description" content="">
    <meta name="exp-language-code" content="">
    <meta name="exp-language-name" content="">

    <link rel="stylesheet" href="css/app.css">



<script id="search-worker" type="javascript/worker">
    onmessage = function(event) {
        // dispatch events to handling functions
        var message = event.data;

        if ((message.type === 'setup') && message.baseUrl) {
            setup(message.baseUrl);
        }

        if (message.type === 'search-request') {
            search(message.query);
        }
    }

    var searchIndex;

    function setup(baseUrl) {
        importScripts(
            baseUrl + 'js/lunr.js',
            baseUrl + 'js/lunr-index.js',
            baseUrl + 'js/lunr-data.js'
        );
        try {
            // load lunr-extras if it exists, which contains language-specific files for languages other than english
            importScripts(baseUrl + 'js/lunr-extras.js');
        } catch (e) {}
        searchIndex = lunr.Index.load(lunrIndex);
    }

    function search(query) {
        var searchHits = searchIndex.search(query);
        var results = searchHits.map(function (result) {
            return lunrData.filter(function (d) {
                return d.id === result.ref;
            })[0]
        });
        postMessage({ type: 'search-results', results: results, query: query });
    }
</script>
    <title>SignServer TimeMonitor Overview</title>

<meta name="generator" content="Scroll HTML Exporter / K15t GmbH"></head>
    <!-- pageid attribute is deprecated - please use data-vp-page-id on html element instead -->
    <body id="SignServerTimeMonitorOverview-top" pageid="371000358" class="flex flex-col" data-confluence-editor-version="v1">
        <div id="vp-js-desktop__navigation__skip-to-navigation-link"></div>




<header class="home-icon-container flex justify-between header hc-header-background-color hc-header-background-color ">
    <div class="header__navigation--logo">
        <a href="SignServer_Documentation.html">
            <img src="_scroll_external/attachments/e415105eb31a/ssdocs" alt="SignServer Documentation" title="SignServer Documentation">
        </a>
    </div>
        <div class="top-bar-right no-print header__navigation--large__menu hc-header-background-color">
    

    <div data-vp-id="search-bar-placeholder" data-vp-component="search-bar" class="vp-search-bar" aria-hidden="true">
        <form action="/search.html" method="GET" class="vp-search-bar__input-container">
            <div data-vp-component="search-input" data-vp-variant="border" class="vp-search-input vp-search-input--border">
                <input type="search" id="search-texbox" autocomplete="off" class="vp-search-input__input" style="margin-right: 0;">
                <div class="vp-search-input__icon" aria-hidden="true">
                    <span class="vp-icon material-icons mdi-magnify w-6 h-6 text-icon-md"></span>
                </div>
            </div>
        </form>
        <div id="search-suggestion-container" class="vp-search-suggestion-panel" data-vp-component="search-suggestion"></div>
        <template id="search-suggestion-option-template">
            <div class="vp-search-suggestion-option-container vp-search-form__suggestion">
                <a class="vp-search-suggestion-option vp-search-form__suggestion" href=""></a>
            </div>
        </template>
    </div>

        </div>
</header>

        <main>



<div class="vp-article vp-container vp-container--with-content-padding article vp-container--full full vp-article--wide">
    <div class="flex">

        <div id="exp-navigation-wrapper" class="hidden lg:block">
            <iframe src="toc.html?pageId=371000358" class="border-0"></iframe>
        </div>


        <div class="vp-article__content-panel flex-auto grid-container full js-loading" id="article-content">
            <article role="article">
                <header>
<nav aria-label="Breadcrumb" role="navigation">
    <div class="breadcrumbs-wrapper">
        <ol class="breadcrumbs breadcrumbs--fit-content js-loading js-loading__stacked js-loading__stacked--breadcrumb">
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Documentation.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Documentation</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Reference.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Reference</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_TimeMonitor_Application.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer TimeMonitor Application</a>
                </li>
            <li class="breadcrumbs--active js-hide-until-loaded">
                <a href="SignServer_TimeMonitor_Overview.html" target="_self" aria-current="page">SignServer TimeMonitor Overview</a>
            </li>
        </ol>
        <div class="breadcrumbs-wrapper__scroll-mask"></div>
    </div>
</nav>
                    <!-- CSS class article__heading is deprecated and will be removed in the future -->
                    <h1 class="cell vp-article__heading article__heading js-loading js-loading__stacked js-loading__stacked--heading scroll-h1 scroll-original-h1 scroll-relative-h1 scroll-custom-section-heading scroll-document-section-heading" role="heading" data-scroll-heading-rank="1" data-scroll-original-heading-rank="1" data-scroll-relative-heading-rank="1" id="no-src_generated-id-77ebe11edc8180338d81f2fca2256fd352d1e337c600f660afdf289353049c4a"><span class="js-hide-until-loaded">SignServer TimeMonitor Overview</span></h1>
                </header>
                <section class="page" id="content" role="main">
                    <div id="vp-js-desktop__navigation__skip-to-navigation-target"></div>
                    <div id="main-content" class="wiki-content article__content js-tocBot-content js-hide-until-loaded">
                        <p>The SignServer TimeMonitor is used together with the <a href="Time_Sources_in_SignServer.html" data-linked-resource-id="371000354" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="371000354" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000354/Time+Sources+in+SignServer" data-scroll-link-target-source-id="371000354">StatusReadingLocalComputerTimeSource</a> for monitoring the local time and informing SignServer about its state.</p><p>The application is started separately from SignServer and runs in its own process. The important main loop repeatably performs the following steps:</p><ol><li>Calculates the time difference between the local time and the time of the time server by sending NTP queries.</li><li>The result is compared with the configured allowed time difference and if the time is within the interval, the time is considered in sync. Additionally, the leap second indicator of the NTP responses is checked.</li><li>The status is then published to SignServer using HTTP. The status is stored with an expiration time and it is therefore important that the application gets time to perform a new round and publish updated results before the expiration.</li></ol><p>Changes to the TimeMonitor states are logged using Log4j as well as published to SignServer.</p><p>The current status of the TimeMonitor can be queried using HTTP from its health check page (see <a href="Logging_and_Monitoring.html" data-linked-resource-id="371000481" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="371000481" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000481/Logging+and+Monitoring" data-scroll-link-target-source-id="371000481">Logging and Monitoring</a>) or from workers configured in SignServer.</p><h2 id="SignServerTimeMonitorOverview-SystemOverview" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">System Overview</h2><p>The following shows an overview of the interactions between SignServer, TimeMonitor, and Time Server.</p><p></p><div class="scroll-diagram-macro-wrapper"><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image confluence-external-resource scroll-document-image" height="286" width="665" src="_scroll_external/attachments/eb7d777a19d1/timemonitorlocalntp.png" loading="lazy"></span></div><p></p><p>Note that the dotted arrow above is only relevant for legacy local NTP commands and not as of SignServer 5.11 where the NTP queries are carried out by the TimeMonitor application using its <a href="TimeMonitor_Configuration.html" data-linked-resource-id="371000477" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000477" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000477/TimeMonitor+Configuration" data-scroll-link-target-source-id="371000477">built-in support for SNTP</a>. Logging and general monitoring are not shown in the example above.</p><h3 id="SignServerTimeMonitorOverview-Assumptions" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-h3 scroll-original-h3 scroll-relative-h3 scroll-custom-section-heading scroll-document-section-heading">Assumptions</h3><ul><li>The local time of the server is synchronized with an external time server using for instance the NTP (or Chrony) daemon.</li><li>The operating system and/or the NTP service takes care of updating the local clock when a leap-second change occurs.</li><li>The external time server is synchronized with a reliable national time source or GPS.</li><li>The external time server has an NTP service that can be queried often from the TimeMonitor application on each server.</li><li>The time-stamp signer(s) uses the StatusReadingLocalComputerTimeSource.<br clear="none"><br clear="none"></li></ul><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The TimeMonitor application can be configured to query the time server more frequently than the NTP standards allow (i.e. more often than every 15 seconds). It is therefore important not to run the TimeMonitor application against an online NTP service. The TimeMonitor application must only be run towards a dedicated NTP server under your own control.</p></div></div><h2 id="SignServerTimeMonitorOverview-Installation" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Installation</h2><p>The application is built with SignServer. In the binary distribution and on the SignServer Hardware Appliance the application is already available but if you build from source you will need to have "includemodulesinbuild=true" (default) or the property "timemonitor.enabled=true" specified in conf/signserver_deploy.properties when building.</p><p>For more information on TimeMonitor configuration options, see <a href="TimeMonitor_Configuration.html" data-linked-resource-id="371000477" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000477" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000477/TimeMonitor+Configuration" data-scroll-link-target-source-id="371000477">TimeMonitor Configuration</a> and for an example of how you can set up TimeMonitor, see <a href="How_to_Configure_TimeMonitor.html" data-linked-resource-id="371000489" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000489" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000489/How+to+Configure+TimeMonitor" data-scroll-link-target-source-id="371000489">How to Configure TimeMonitor</a>.</p>
<nav id="ht-post-nav">
        <a href="Time_Sources_in_SignServer.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Time Sources in SignServer</span>
        </a>

        <a href="TimeMonitor_Configuration.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>TimeMonitor Configuration</span>
        </a>
</nav>
                    </div>
                </section>
            </article>
        </div>

        <div class="vp-article__aside-right flex-shrink-0 w-1/6 article__toc hidden xl:block no-print">
            <div class="vp-scrollable-container vp-scrollable-container--hidden-scrollbars">
                <div class="js-tocBot">
                                    </div>
            </div>
        </div>

    </div>
</div>
        </main>


        <div id="vp-js-mobile__navigation">
            <div tabindex="-1" class="vp-mobile-navigation__trigger fixed outline-none z-mobile-menu-trigger">
                <button type="button" class="vp-button vp-button--variant-floating-action vp-mobile-navigation__button flex items-center justify-center" aria-label="navigation.open.label">
                    <div class="vp-mobile-navigation__button__icon relative">
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                    </div>
                </button>
            </div>
        </div>

        <script src="js/app.js"></script>
    </body>
</html>