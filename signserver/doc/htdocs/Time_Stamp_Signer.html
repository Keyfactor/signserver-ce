<!doctype html>

<html class="no-js" lang="en" data-vp-page-id="370999946">


    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="_scroll_external/attachments/e415105eb31a/ssdocs">

    <!-- Primary Meta Tags -->
    <meta name="exp-export-timestamp" content="2024-04-17T13:23:03.722+0000">
    <meta name="exp-page-id" content="370999946">
    <meta name="exp-page-title" content="Time Stamp Signer">
    <meta name="exp-page-version" content="1">
    <meta name="exp-page-scroll-page-id" content="3ca46b80c18527423c41ebb3f399a53e">
    <meta name="exp-page-created" content="2020-09-08T07:28:50.000+0000">
    <meta name="exp-page-last-modified" content="2020-09-08T07:46:16.000+0000">
    <meta name="exp-page-labels" content="timestamp">
    <meta name="exp-page-context-keys" content="">
    <meta name="exp-space-key" content="SSDOCS">
    <meta name="exp-space-title" content="SignServer Documentation">


    <link rel="stylesheet" href="css/app.css">



<script id="search-worker" type="javascript/worker">
    onmessage = function(event) {
        // dispatch events to handling functions
        var message = event.data;

        if ((message.type === 'setup') && message.baseUrl) {
            setup(message.baseUrl);
        }

        if (message.type === 'search-request') {
            search(message.query);
        }
    }

    var searchIndex;

    function setup(baseUrl) {
        importScripts(
            baseUrl + 'js/lunr.js',
            baseUrl + 'js/lunr-index.js',
            baseUrl + 'js/lunr-data.js'
        );
        try {
            // load lunr-extras if it exists, which contains language-specific files for languages other than english
            importScripts(baseUrl + 'js/lunr-extras.js');
        } catch (e) {}
        searchIndex = lunr.Index.load(lunrIndex);
    }

    function search(query) {
        var searchHits = searchIndex.search(query);
        var results = searchHits.map(function (result) {
            return lunrData.filter(function (d) {
                return d.id === result.ref;
            })[0]
        });
        postMessage({ type: 'search-results', results: results, query: query });
    }
</script>
    <title>Time Stamp Signer</title>

<meta name="generator" content="Scroll HTML Exporter / K15t GmbH"></head>
    <!-- pageid attribute is deprecated - please use data-vp-page-id on html element instead -->
    <body id="TimeStampSigner-top" pageid="370999946" class="flex flex-col" data-confluence-editor-version="v1">
        <div id="vp-js-desktop__navigation__skip-to-navigation-link"></div>




<header class="home-icon-container flex justify-between header hc-header-background-color hc-header-background-color ">
    <div class="header__navigation--logo">
        <a href="SignServer_Manual.html">
            <img src="_scroll_external/attachments/e415105eb31a/ssdocs" alt="SignServer Documentation" title="SignServer Documentation">
        </a>
    </div>
        <div class="top-bar-right no-print header__navigation--large__menu hc-header-background-color">
    

    <div data-vp-id="search-bar-placeholder" data-vp-component="search-bar" class="vp-search-bar" aria-hidden="true">
        <form action="/search.html" method="GET" class="vp-search-bar__input-container">
            <div data-vp-component="search-input" data-vp-variant="border" class="vp-search-input vp-search-input--border">
                <input type="search" id="search-texbox" autocomplete="off" class="vp-search-input__input" style="margin-right: 0;">
                <div class="vp-search-input__icon" aria-hidden="true">
                    <span class="vp-icon material-icons mdi-magnify w-6 h-6 text-icon-md"></span>
                </div>
            </div>
        </form>
        <div id="search-suggestion-container" class="vp-search-suggestion-panel" data-vp-component="search-suggestion"></div>
        <template id="search-suggestion-option-template">
            <div class="vp-search-suggestion-option-container vp-search-form__suggestion">
                <a class="vp-search-suggestion-option vp-search-form__suggestion" href=""></a>
            </div>
        </template>
    </div>

        </div>
</header>

        <main>



<div class="vp-article vp-container vp-container--with-content-padding article vp-container--full full vp-article--wide">
    <div class="flex">

        <div id="exp-navigation-wrapper" class="hidden lg:block">
            <iframe src="toc.html?pageId=370999946" class="border-0"></iframe>
        </div>


        <div class="vp-article__content-panel flex-auto grid-container full js-loading" id="article-content">
            <article role="article">
                <header>
<nav aria-label="Breadcrumb" role="navigation">
    <div class="breadcrumbs-wrapper">
        <ol class="breadcrumbs breadcrumbs--fit-content js-loading js-loading__stacked js-loading__stacked--breadcrumb">
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Manual.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Manual</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Reference.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Reference</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Workers.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Workers</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Signers.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Signers</a>
                </li>
            <li class="breadcrumbs--active js-hide-until-loaded">
                <a href="Time_Stamp_Signer.html" target="_self" aria-current="page">Time Stamp Signer</a>
            </li>
        </ol>
        <div class="breadcrumbs-wrapper__scroll-mask"></div>
    </div>
</nav>
                    <!-- CSS class article__heading is deprecated and will be removed in the future -->
                    <h1 class="cell vp-article__heading article__heading js-loading js-loading__stacked js-loading__stacked--heading scroll-h1 scroll-original-h1 scroll-relative-h1 scroll-custom-section-heading scroll-document-section-heading" role="heading" data-scroll-heading-rank="1" data-scroll-original-heading-rank="1" data-scroll-relative-heading-rank="1" id="no-src_generated-id-b8f66c66e4f842e06b03d7bf2715002782822afd79e3add516c824bffbb014b6"><span class="js-hide-until-loaded">Time Stamp Signer</span></h1>
                </header>
                <section class="page" id="content" role="main">
                    <div id="vp-js-desktop__navigation__skip-to-navigation-target"></div>
                    <div id="main-content" class="wiki-content article__content js-tocBot-content js-hide-until-loaded">
                        <div class="section"><p>The signer has the class name: <strong>org.signserver.server.signers.TimeStampSigner</strong>.</p><h2 id="TimeStampSigner-Overview" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Overview</h2><p>The time stamp server generates time stamp tokens and supports the following options:</p><div class="section"><ul><li>Set of accepted policies</li><li>Set of accepted algorithms</li><li>Set of accepted extensions</li><li>Accuracy microseconds</li><li>Accuracy milliseconds</li><li>Accuracy seconds</li><li>Included certificate chain (currently doesn't include CRLs)</li><li>Ordering</li><li>TSA name<br clear="none"><br clear="none"></li></ul><p>Time-stamp requests are served through a HTTP(S) service at the URL:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>http://&lt;host name&gt;/signserver/process?workerId=&lt;worker Id&gt;</pre>
</div></div><p>The time-stamp signer requires a time-stamp certificate with the extended key usage <strong>time-stamp</strong> only. The extended key usage extension must be critical.</p><p>If the time-stamp request contains a nonce value, this value will also be included in the time-stamp token.</p></div><h2 id="TimeStampSigner-AvailableProperties" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Available Properties</h2><div class="section">The following properties can be configured with the signer:</div><div class="section"><p><br clear="none"></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 99.9382%;"><colgroup span="1"><col span="1" style="width: 11.9637%;"><col span="1" style="width: 88.0088%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>TIMESOURCE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Property containing the fully qualified name of the class implementing the ITimeSource that should be used (OPTIONAL). Below are the built-in TimeSourceS available:<br clear="none"><strong>org.signserver.server.LocalComputerTimeSource</strong><br clear="none">This is the default TimeSource and uses the time from the local computer and always returns the time.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><br clear="none"></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><strong>org.signserver.server.StatusReadingLocalComputerTimeSource</strong><br clear="none">This TimeSource returns the time from the local computer but only if the status property TIMESOURCE0_INSYNC is not expired and returned as <strong>true</strong>&nbsp;from the Status Repository.</p><p>Worker properties:</p><ul><li><strong>LEAPSECOND_HANDLING</strong>: NONE, PAUSE or STOP. Default is NONE.<ul><li><em>NONE</em>: Leap seconds are not considered and time-stamp tokens are issued as usual.</li><li><em>PAUSE</em>: The TimeSource will query the status property&nbsp;<em>LEAPSECOND</em>&nbsp;from the Status Repository. If this property is not expired, and has the value <em>POSITIVE </em>or <em>NEGATIVE </em>and current time is in the interval surrounding a potential leap second (23:59:58,989 - 00:00:01,010) (at month shifts, in UTC time), the TimeSource will make a pause to ensure the time value is not fetch on the leap second. The value&nbsp;<em>NONE</em>&nbsp;is interpreted as there is no leap second and the time value will be returned immediately as usual. If the value has expired, no valid time will be returned.</li><li><em>STOP:</em>&nbsp;The TimeSource will query the status property in the same way as for the PAUSE strategy. During the interval surrounding a potential leap second no time will be returned. This will cause the response to the clients to be timeSourceNotAvailable. If the LEAPSECOND status property value has expired, no valid time will be returned.</li></ul>This time source will add an additional worker status item indicating the currently used leap second strategy.The following additional log fields will be included for a logger implementation to use:<ul><li><em>LEAP_UPCOMING:</em>&nbsp;This field will have the value&nbsp;<em>true</em>&nbsp;if a leap second is known to be coming soon,&nbsp;<em>false</em>&nbsp;if there is no leap second known to be coming, or&nbsp;<em>unknown</em>&nbsp;if it was unable to read the status.<em>LEAP_PERIOD</em>&nbsp;This field will be included when&nbsp;<em>LEAP_UPCOMING</em>&nbsp;is true and has the value&nbsp;<em>true</em>&nbsp;or&nbsp;<em>false</em>&nbsp;depending on whether the request was made during the time interval surrounding a leap second.<em>LEAP_ACTION</em>&nbsp;This field will include the value of the currently used leap second strategy.</li></ul></li></ul></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>SIGNATUREALGORITHM&nbsp;</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Property specifying the algorithm used to sign the timestamp. Default: SHA256withRSA.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCEPTEDALGORITHMS&nbsp;</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>A ';' separated string containing accepted algorithms. Can be null if it should not be used. OPTIONAL but strongly recommended. Supported Algorithms are: GOST3411, MD5, SHA1, SHA224, SHA256, SHA384, SHA512, RIPEMD128, RIPEMD160, RIPEMD256.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCEPTEDPOLICIES&nbsp;</p></td><td colspan="1" rowspan="1" class="confluenceTd"><div class="content-wrapper"><p>A ';' separated string containing accepted policies.</p><p><img class="emoticon emoticon-warning scroll-document-image" data-emoji-id="atlassian-warning" data-emoji-shortname=":warning:" data-emoji-fallback=":warning:" src="_scroll_external/icons/754c3e37f939/warning.png" width="16" height="16" data-emoticon-name="warning" alt="(varning)"> Note that only policies listed in this property are allowed to be requested. If the property does not contain any policies, then no policy can be requested. Requests not including any policy will use the default policy regardless of this property, but requests explicitly requesting the default policy will still not be allowed unless listed in this property. If this property is used, ACCEPTANYPOLICY cannot be set to true. OPTIONAL, recommended.</p></div></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCEPTANYPOLICY&nbsp;</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>If set to true, allow any policy. If set to true, ACCEPTEDPOLICIES cannot be set. Optionally, this can be set to false or left empty when setting ACCEPTEDPOLICIES.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCEPTEDEXTENSIONS&nbsp;</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>A ';' separated string containing accepted extensions, can be null if it should not be used. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>DEFAULTTSAPOLICYOID</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The default policy ID of the time stamp authority. REQUIRED, if no policy OID is specified in the request, then will this value be used.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCURACYMICROS</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Accuracy in microseconds as an integer, can be combined additively with ACCURACYMILLIS and ACCURACYSECONDS. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCURACYMILLIS</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Accuracy in milliseconds as an integer, can be combined additively with ACCURACYMICROS and ACCURACYSECONDS. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACCURACYSECONDS</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Accuracy in seconds as an integer, can be combined additively with ACCURACYMICROS and ACCURACYMILLIS. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ORDERING</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The ordering (OPTIONAL), default false. Only false is supported.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>INCLUDEORDERING</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>If set to true, always include the ordering attribute, even when ORDERING is set to false. It is not allowed to set this to false when ORDERING is set to true, default is false. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>TSA</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>General name of the Time Stamp Authority. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>TSA_FROM_CERT</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Setting this property to true sets the general name of the Time Stamp Authority to the subject DN of the signing certificate. This cannot be set to true if the TSA property is set. OPTIONAL, default is to not set the general name.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>REQUIREVALIDCHAIN</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Set to true to perform an extra check that the SIGNERCERTCHAIN only contains certificates in the chain of the signer certificate. OPTIONAL, default false.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>MAXSERIALNUMBERLENGTH</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The maximum size (in bytes) used when generating serial numbers, must be between 8 and 20 (64 - 160 bits) (Default: 8). The generated serial number will always be positive (so the sign bit is always a zero).</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>WORKERLOGGER</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>As for other workers this property can be used to specify which worker logger to use. By default, the&nbsp;<a href="Worker_Log.html" data-linked-resource-id="371000306" data-linked-resource-version="1" data-linked-resource-type="page" data-scroll-target-source-id="371000306" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000306/Worker+Log" data-scroll-link-target-source-id="371000306">DefaultTimeStampLogger</a>&nbsp;is used.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>INCLUDESTATUSSTRING</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies if the status string is to be included in the response. Setting this to true triggers a bug in some versions of OpenJDK's jarsigner utility, default is false. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>INCLUDE_CERTID_ISSUERSERIAL</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies if the signingCertificate (or signingCertificateV2) attribute's ESSCertID should include the issuer and serial number in addition to the certificate hash. Default is true.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>INCLUDESIGNINGTIMEATTRIBUTE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies if the signingTime signed CMS attribute should be included in the response, default is true. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>INCLUDECMSALGORITHMPROTECTATTRIBUTE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies if the cmsAlgorithmProtect (RFC#6211) signed attribute should be included in the response, default is true. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CERTIFICATE_DIGEST_ALGORITHM</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies the digest algorithm used for calculating the digest of the signing certificate. Supported values are:&nbsp;SHA1,&nbsp;SHA224,&nbsp;SHA256,&nbsp;SHA384,&nbsp;SHA512.<br clear="none">When using an algorithm other than SHA1, RFC 5816-compliant time stamps will be issued. To get the old behavior (with the ESSCertID attribute instead of ESSCertIDv2), SHA1 must be set explicitly. Default: SHA256.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>LEGACYENCODING</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>As of SignServer 4.0, the encoding of the time-stamp tokens has changed. One consequence is that the order of the certificates in the output might not be the same as in the certificate chain due to the DER encoding and the fact that the certificates field is a set and thus not ordered. To restore the old behavior, set LEGACYENCODING=true. Default is false. OPTIONAL.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>VERIFY_TOKEN_SIGNATURE</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specifies if the timestamp token signature is to be validated after signing. Signing fails if validation is not successful. Default is true.</p></td></tr></tbody></table></div><h2 id="TimeStampSigner-CertificateRequirements" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Certificate Requirements</h2><ul><li>Specifying a signer certificate is required as information from that certificate will be used to indicate which signer signed the time-stamp token.</li><li>The signer certificate chain contains all certificates included in the token if the client requests the certificates.</li><li>The signer certificate MUST be included in the configured certificate chain. Other certificates might also be included in the chain (typically intermediate CA certificates). However, if REQUIREVALIDCHAIN=true is specified, only the signer certificate, directly followed by its issuer and then the issuer's issuer and so on, is allowed. All certificates will be verified if there is a certificate coming after it. No check is made that the last certificate is a root certificate as that certificate is usually not included.</li><li>A time-stamp signer certificate must have the extended key usage extension present and marked as critical.</li><li>The extended key usage extension must contain the timeStamping key purpose ID and only that one.</li></ul></div></div>
<nav id="ht-post-nav">
        <a href="QoS_Status_Worker.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>QoS Status Worker</span>
        </a>

        <a href="Time_Stamp_Signer_Algorithm_Support.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>Time Stamp Signer Algorithm Support</span>
        </a>
</nav>
                    </div>
                </section>
            </article>
        </div>

        <div class="vp-article__aside-right flex-shrink-0 w-1/6 article__toc hidden xl:block no-print">
            <div class="vp-scrollable-container vp-scrollable-container--hidden-scrollbars">
                <div class="js-tocBot">
                                    </div>
            </div>
        </div>

    </div>
</div>
        </main>


        <div id="vp-js-mobile__navigation">
            <div tabindex="-1" class="vp-mobile-navigation__trigger fixed outline-none z-mobile-menu-trigger">
                <button type="button" class="vp-button vp-button--variant-floating-action vp-mobile-navigation__button flex items-center justify-center" aria-label="navigation.open.label">
                    <div class="vp-mobile-navigation__button__icon relative">
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                    </div>
                </button>
            </div>
        </div>

        <script src="js/app.js"></script>
    </body>
</html>