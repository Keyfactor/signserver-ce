<!doctype html>

<html class="no-js" lang="en" data-vp-page-id="371000002">


    
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="shortcut icon" href="_scroll_external/attachments/e415105eb31a/ssdocs">

    <!-- Primary Meta Tags -->
    <meta name="exp-export-timestamp" content="2024-04-17T13:23:05.336+0000">
    <meta name="exp-page-id" content="371000002">
    <meta name="exp-page-title" content="ZoneHashSigner">
    <meta name="exp-page-version" content="1">
    <meta name="exp-page-scroll-page-id" content="440ac39215068a8b70f9225b526a3a3a">
    <meta name="exp-page-created" content="2023-02-07T16:53:45.000+0000">
    <meta name="exp-page-last-modified" content="2023-02-14T09:08:09.000+0000">
    <meta name="exp-page-labels" content="code,document,review">
    <meta name="exp-page-context-keys" content="">
    <meta name="exp-space-key" content="SSDOCS">
    <meta name="exp-space-title" content="SignServer Documentation">


    <link rel="stylesheet" href="css/app.css">



<script id="search-worker" type="javascript/worker">
    onmessage = function(event) {
        // dispatch events to handling functions
        var message = event.data;

        if ((message.type === 'setup') && message.baseUrl) {
            setup(message.baseUrl);
        }

        if (message.type === 'search-request') {
            search(message.query);
        }
    }

    var searchIndex;

    function setup(baseUrl) {
        importScripts(
            baseUrl + 'js/lunr.js',
            baseUrl + 'js/lunr-index.js',
            baseUrl + 'js/lunr-data.js'
        );
        try {
            // load lunr-extras if it exists, which contains language-specific files for languages other than english
            importScripts(baseUrl + 'js/lunr-extras.js');
        } catch (e) {}
        searchIndex = lunr.Index.load(lunrIndex);
    }

    function search(query) {
        var searchHits = searchIndex.search(query);
        var results = searchHits.map(function (result) {
            return lunrData.filter(function (d) {
                return d.id === result.ref;
            })[0]
        });
        postMessage({ type: 'search-results', results: results, query: query });
    }
</script>
    <title>ZoneHashSigner</title>

<meta name="generator" content="Scroll HTML Exporter / K15t GmbH"></head>
    <!-- pageid attribute is deprecated - please use data-vp-page-id on html element instead -->
    <body id="ZoneHashSigner-top" pageid="371000002" class="flex flex-col" data-confluence-editor-version="v1">
        <div id="vp-js-desktop__navigation__skip-to-navigation-link"></div>




<header class="home-icon-container flex justify-between header hc-header-background-color hc-header-background-color ">
    <div class="header__navigation--logo">
        <a href="SignServer_Manual.html">
            <img src="_scroll_external/attachments/e415105eb31a/ssdocs" alt="SignServer Documentation" title="SignServer Documentation">
        </a>
    </div>
        <div class="top-bar-right no-print header__navigation--large__menu hc-header-background-color">
    

    <div data-vp-id="search-bar-placeholder" data-vp-component="search-bar" class="vp-search-bar" aria-hidden="true">
        <form action="/search.html" method="GET" class="vp-search-bar__input-container">
            <div data-vp-component="search-input" data-vp-variant="border" class="vp-search-input vp-search-input--border">
                <input type="search" id="search-texbox" autocomplete="off" class="vp-search-input__input" style="margin-right: 0;">
                <div class="vp-search-input__icon" aria-hidden="true">
                    <span class="vp-icon material-icons mdi-magnify w-6 h-6 text-icon-md"></span>
                </div>
            </div>
        </form>
        <div id="search-suggestion-container" class="vp-search-suggestion-panel" data-vp-component="search-suggestion"></div>
        <template id="search-suggestion-option-template">
            <div class="vp-search-suggestion-option-container vp-search-form__suggestion">
                <a class="vp-search-suggestion-option vp-search-form__suggestion" href=""></a>
            </div>
        </template>
    </div>

        </div>
</header>

        <main>



<div class="vp-article vp-container vp-container--with-content-padding article vp-container--full full vp-article--wide">
    <div class="flex">

        <div id="exp-navigation-wrapper" class="hidden lg:block">
            <iframe src="toc.html?pageId=371000002" class="border-0"></iframe>
        </div>


        <div class="vp-article__content-panel flex-auto grid-container full js-loading" id="article-content">
            <article role="article">
                <header>
<nav aria-label="Breadcrumb" role="navigation">
    <div class="breadcrumbs-wrapper">
        <ol class="breadcrumbs breadcrumbs--fit-content js-loading js-loading__stacked js-loading__stacked--breadcrumb">
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Manual.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Manual</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Reference.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Reference</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Workers.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Workers</a>
                </li>
                <li class="js-hide-until-loaded">
                    <a href="SignServer_Signers.html" rel="prev" target="_self" class="js-breadcrumbs-truncate">SignServer Signers</a>
                </li>
            <li class="breadcrumbs--active js-hide-until-loaded">
                <a href="ZoneHashSigner.html" target="_self" aria-current="page">ZoneHashSigner</a>
            </li>
        </ol>
        <div class="breadcrumbs-wrapper__scroll-mask"></div>
    </div>
</nav>
                    <!-- CSS class article__heading is deprecated and will be removed in the future -->
                    <h1 class="cell vp-article__heading article__heading js-loading js-loading__stacked js-loading__stacked--heading scroll-h1 scroll-original-h1 scroll-relative-h1 scroll-custom-section-heading scroll-document-section-heading" role="heading" data-scroll-heading-rank="1" data-scroll-original-heading-rank="1" data-scroll-relative-heading-rank="1" id="no-src_generated-id-ca9a27894dcec3c89992b2ca633a2a0c5d6e83df7b0fe425157f5d93b9cb0594"><span class="js-hide-until-loaded">ZoneHashSigner</span></h1>
                </header>
                <section class="page" id="content" role="main">
                    <div id="vp-js-desktop__navigation__skip-to-navigation-target"></div>
                    <div id="main-content" class="wiki-content article__content js-tocBot-content js-hide-until-loaded">
                        <p>The&nbsp;ZoneHashSigner signer has the fully qualified class name:&nbsp;<strong>org.signserver.module.dnssec.signer.ZoneHashSigner</strong></p><h2 id="ZoneHashSigner-Overview" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Overview</h2><p>The ZoneHashSigner signer can be used to sign DNS zone zip files using the SignClient in client-side hashing and construction mode, contained in a zip file, using DNS Security Extensions (DNSSEC).</p><p>For information on invoking the SignClient, see&nbsp;DNSSEC Signing in <a href="Client-Side_Hashing.html" data-linked-resource-id="371000790" data-linked-resource-version="2" data-linked-resource-type="page" data-scroll-target-source-id="371000790" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000790/Client-Side+Hashing" data-scroll-link-target-source-id="371000790">Client-Side Hashing</a>.</p><p>The signer is designed around a two-stage request-response protocol, see <a href="ZoneHashSigner.html#ZoneHashSigner-Protocol" data-scroll-target-source-id="371000002" class=" scroll-document-link" data-scroll-link-type="document" data-scroll-link-target="https://keyfactor.atlassian.net/wiki/spaces/SSDOCS/pages/371000002/ZoneHashSigner#src-371000002_ZoneHashSigner-Protocol" data-scroll-link-target-source-id="371000002">Protocol</a>.</p><h2 id="ZoneHashSigner-AvailableProperties" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Available Properties</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup span="1"><col span="1"><col span="1"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ZSK_KEY_ALIAS_PREFIX</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Key alias prefix to use for zone signing. The key used will be based on the prefix with the key sequence number appended. Required. Example: "example.com_Z_".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ACTIVE_KSKS</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Active key signing keys to use. Must specify exactly 1 or 2 key aliases, comma-separated. Required. Example: "example.com_K_1,example.com_K_2".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ZONE_NAME</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The name of the top-level zone in the zone file. Required. Example: "example.com.".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>PUBLISH_PREVIOUS_ZSK</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>If the previous ZSK (if one) should be kept published. Optional. Example: "false". Default: "true".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>NSEC3_SALT</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Fixed, hex-encoded salt (64-bit value) to use instead of a random salt for testing/troubleshooting purposes. Optional. Example: "6dcd4ce23d88e2ee".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>DISABLEKEYUSAGECOUNTER</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Disables the key usage counter. As the key usage counter is not supported by this signer, if set, only the value "true" is supported.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>SIGNATUREALGORITHM</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Signature algorithm to use for all signatures. Default: "SHA256withRSA". Currently only "SHA256withRSA is supported. All signature algorithms map to DNSSEC algorithms using NSEC3 and the NONEwithRSA algorithm is used for signing the digests.</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>CHECK_ACTIVE_KSKS</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>True if the keys configured in ACTIVE_KSKS should be checked for existence. Setting CHECK_ACTIVE_KSKS to "false" can improve performance in some environments when listing zone file signers in AdminWeb and when calling health check. Default: "true".</p></td></tr></tbody></table></div><h2 id="ZoneHashSigner-RequestParameters" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Request Parameters</h2><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 67.4401%;"><colgroup span="1"><col span="1" style="width: 21.4463%;"><col span="1" style="width: 78.5593%;"></colgroup><thead><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>ZSK_SEQUENCE_NUMBER</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Sequence number to append after key alias prefix. Example: "1".</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p>SOA_TTL</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Specify the TTL of the SOA (start of authority) record in seconds. This is only used for the pre-request. This property is required when sending the pre-request.</p></td></tr></tbody></table></div><h2 id="ZoneHashSigner-Protocol" data-scroll-heading-rank="2" data-scroll-original-heading-rank="2" data-scroll-relative-heading-rank="2" class="scroll-h2 scroll-original-h2 scroll-relative-h2 scroll-custom-section-heading scroll-document-section-heading">Protocol</h2><p>Due to the way DNSSEC zone file signing works, this signer is designed around a two-stage request-response protocol.</p><p>In the first request (pre-sign request), the request body is empty (this tells the signer that the request is a pre-request). The request metadata parameters ZSK_SEQUENCE_NUMBER and SOA_TTL are included to indicate the zone signing key sequence number to use and the TTL (Time To Live) of the SOA (Start of Authority) record.</p><p>The signer sends back a pre-sign response with DNSKEY records, signature records for the DNSKEY records, and the NSEC3PARAM record. These are encoded in the response in the format of a Java properties file.</p><p>The client will then construct the sign request containing the same ZSK_SEQUENCE_NUMBER as in the pre-sign request, the same SIG record data as received from the pre-sign response, and mappings from each RRsetId to hash that should be signed. The hash is calculated using the SIG record data received in the pre-sign response and the RRset. The server verifies that the received footprint is correct (and matches the ZSK_SEQUENCE_NUMBER). The server signs each hash and responds with a sign response containing a mapping from the same ID:s provided in the sign request to the signature values. The response data is formatted as a Java properties file. The receiving client (for example, the SignClient) then constructs each SIG record and inserts the signature received from the server.</p><h3 id="ZoneHashSigner-Pre-signrequest" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-h3 scroll-original-h3 scroll-relative-h3 scroll-custom-section-heading scroll-document-section-heading">Pre-sign request</h3><ul><li><strong>Metadata</strong><pre>ZSK_SEQUENCE_NUMBER=1, SOA_TTL=86400<br clear="none"><br clear="none"></pre></li><li><strong>Request body</strong><br clear="none">&lt;Empty&gt;</li></ul><h3 id="ZoneHashSigner-Pre-signresponse" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-h3 scroll-original-h3 scroll-relative-h3 scroll-custom-section-heading scroll-document-section-heading">Pre-sign response</h3><ul><li><strong>Response body</strong><pre class="code-java">rr.dnskey.z1.expiretime=1577011258284<br clear="none">rr.dnskey.z1.signingtime=1574419258284<br clear="none">rr.dnskey.z1.footprint=11644<br clear="none">rr.dnskey.z1.algorithm=8<br clear="none"><br clear="none">rr.dnskey.z0=...base64 of wire format for DNSKEY 256 (if one)...<br clear="none">rr.dnskey.z1=...base64 of wire format for DNSKEY 256...
rr.dnskey.z2=...base64 of wire format for DNSKEY 256 (if one)...
rr.dnskey.k1=...base64 of wire format for DNSKEY 257...
rr.dnskey.k2=...base64 of wire format for DNSKEY 257 (if one)...
rr.dnskey.sig.z1=...base64 of wire format for RRSIG with Z1 key...
rr.dnskey.sig.k1=...base64 of wire format for RRSIG with K1 key...
rr.dnskey.sig.k2=...base64 of wire format for RRSIG with K2 key (if one)...
rr.nsec3param=...base64 of wire format for NSEC3PARAM...
rr.nsec3param.sig=...base64 of wire format for RRSIG of NSEC3PARAM...</pre></li></ul><h3 id="ZoneHashSigner-Signrequest" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-h3 scroll-original-h3 scroll-relative-h3 scroll-custom-section-heading scroll-document-section-heading">Sign request</h3><ul><li><strong>Metadata</strong><pre class="code-java">ZSK_SEQUENCE_NUMBER=10, rr.dnskey.z1.expiretime=1577011258284, rr.dnskey.z1.signingtime=1574419258284, rr.dnskey.z1.footprint=11644, rr.dnskey.z1.algorithm=8<br clear="none"><br clear="none"></pre></li><li><p><strong>Request body<br clear="none"></strong>hash.1=...base64 of hash or signature input... <br clear="none">hash.2=... <br clear="none">hash.N=...</p></li></ul><h3 id="ZoneHashSigner-Signresponse" data-scroll-heading-rank="3" data-scroll-original-heading-rank="3" data-scroll-relative-heading-rank="3" class="scroll-h3 scroll-original-h3 scroll-relative-h3 scroll-custom-section-heading scroll-document-section-heading">Sign response</h3><ul><li><strong>Response body</strong><pre class="code-java">sig.1=...base64 of signature of hash.1...
sig.2=...
sig.N=...</pre></li></ul>
<nav id="ht-post-nav">
        <a href="ZoneFileServerSideSigner.html" class="ht-post-nav-prev">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-prev" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-45.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>ZoneFileServerSideSigner</span>
        </a>

        <a href="ZoneZipFileServerSideSigner.html" class="ht-post-nav-next">
            <svg width="22px" height="22px" viewbox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
                <g id="ht-icon-next" sketch:type="MSArtboardGroup">
                    <path fill="#000000" d="M16,8 L16,6 L6,6 L6,16 L8,16 L8,8 L16,8 Z" id="Rectangle-2" sketch:type="MSShapeGroup" transform="translate(11.000000, 11.000000) rotate(-225.000000) translate(-11.000000, -11.000000) "></path>
                </g>
            </svg>
            <span>ZoneZipFileServerSideSigner</span>
        </a>
</nav>
                    </div>
                </section>
            </article>
        </div>

        <div class="vp-article__aside-right flex-shrink-0 w-1/6 article__toc hidden xl:block no-print">
            <div class="vp-scrollable-container vp-scrollable-container--hidden-scrollbars">
                <div class="js-tocBot">
                                    </div>
            </div>
        </div>

    </div>
</div>
        </main>


        <div id="vp-js-mobile__navigation">
            <div tabindex="-1" class="vp-mobile-navigation__trigger fixed outline-none z-mobile-menu-trigger">
                <button type="button" class="vp-button vp-button--variant-floating-action vp-mobile-navigation__button flex items-center justify-center" aria-label="navigation.open.label">
                    <div class="vp-mobile-navigation__button__icon relative">
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                        <div class="absolute w-full"></div>
                    </div>
                </button>
            </div>
        </div>

        <script src="js/app.js"></script>
    </body>
</html>