<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.2  (Win32)">
	<META NAME="CREATED" CONTENT="20060126;8484600">
	<META NAME="CHANGEDBY" CONTENT="Philip Vendil">
	<META NAME="CHANGED" CONTENT="20080117;8205327">
	<META NAME="SDFOOTNOTE" CONTENT=";;;;P">
	<META NAME="SDENDNOTE" CONTENT="ARABIC">
	<STYLE TYPE="text/css">
	<!--
		@page { size: 21cm 29.7cm; margin: 2cm }
		P { margin-bottom: 0cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2 }
		P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-GB }
		P.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 14pt; so-language: ja-JP }
		H1 { margin-bottom: 0.21cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2; page-break-after: auto }
		H1.western { font-family: "Times New Roman", serif; font-size: 14pt; so-language: en-GB }
		H1.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 14pt; so-language: ja-JP }
		H1.ctl { font-family: "Arial Unicode MS"; font-size: 12pt; font-weight: medium }
		H2 { margin-top: 0.21cm; margin-bottom: 0cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2 }
		H2.western { font-size: 14pt; so-language: en-GB; font-style: italic; font-weight: medium }
		H2.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 12pt; so-language: ja-JP; font-weight: medium }
		H2.ctl { font-family: "Arial Unicode MS"; font-size: 12pt; font-weight: medium }
		H3 { margin-top: 0cm; margin-bottom: 0cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2 }
		H3.western { font-family: "Times", serif; so-language: en-GB; font-style: italic; font-weight: medium }
		H3.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 10pt; so-language: ja-JP; font-weight: medium }
		H3.ctl { font-family: "Arial Unicode MS"; font-size: 12pt; font-weight: medium }
		H4 { margin-bottom: 0.11cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2 }
		H4.western { so-language: en-GB; font-weight: medium }
		H4.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 10pt; so-language: ja-JP; font-weight: medium }
		H4.ctl { font-family: "Arial Unicode MS"; font-size: 12pt; font-weight: medium }
		TD P { margin-bottom: 0cm; background: transparent; color: #000000; text-align: left; widows: 2; orphans: 2 }
		TD P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-GB }
		TD P.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 14pt; so-language: ja-JP }
		TH P { margin-bottom: 0cm; background: transparent; color: #000000; widows: 2; orphans: 2 }
		TH P.western { font-family: "Times New Roman", serif; font-size: 12pt; so-language: en-GB; font-style: italic }
		TH P.cjk { font-family: "MS Mincho", "MS ??", monospace; font-size: 14pt; so-language: ja-JP; font-style: italic }
		TH P.ctl { font-style: italic }
		A:link { color: #0000ff }
		A:visited { color: #800080 }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" TEXT="#000000" LINK="#0000ff" VLINK="#800080" DIR="LTR">
<DIV TYPE=HEADER>
	<P LANG="en-GB"><BR>
	</P>
	<TABLE WIDTH=611 BORDER=1 BORDERCOLOR="#000000" CELLPADDING=5 CELLSPACING=0 RULES=NONE>
		<COL WIDTH=152>
		<COL WIDTH=229>
		<COL WIDTH=115>
		<COL WIDTH=73>
		<TR VALIGN=TOP>
			<TD ROWSPAN=2 WIDTH=152>
				<P LANG="en-GB"><BR>
				</P>
			</TD>
			<TD ROWSPAN=2 COLSPAN=2 WIDTH=354>
				<P LANG="en-GB" ALIGN=CENTER STYLE="margin-top: 0.21cm">
				<FONT FACE="Verdana, sans-serif"><FONT SIZE=2><FONT SIZE=2><SPAN LANG="en-US">SignServer,
				Manual</SPAN></FONT><FONT SIZE=2> </FONT><FONT SIZE=2><SDFIELD TYPE=DOCINFO SUBTYPE=TITLE></SDFIELD></FONT></FONT></FONT></P>
			</TD>
			<TD WIDTH=73 HEIGHT=5>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B>Sidnr
				/ <I>Page no</I></B></FONT></FONT></FONT></P>
			</TD>
		</TR>
		<TR>
			<TD WIDTH=73 HEIGHT=6 VALIGN=TOP>
				<P LANG="en-GB"><SPAN STYLE="text-decoration: none"><SDFIELD TYPE=PAGE SUBTYPE=RANDOM FORMAT=PAGE>51</SDFIELD></SPAN><SPAN STYLE="text-decoration: none">
				<FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT FACE="Verdana, sans-serif">(</FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Verdana, sans-serif"><SDFIELD TYPE=DOCSTAT SUBTYPE=PAGE FORMAT=ARABIC>51</SDFIELD></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Verdana, sans-serif">)</FONT></SPAN></FONT></FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD COLSPAN=2 WIDTH=391 HEIGHT=1>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B>Uppgjort
				/ <I>Auhtor	</I></B></FONT></FONT></FONT></P>
			</TD>
			<TD COLSPAN=2 WIDTH=197>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B>Sekretess
				/ <I>Confidentiality</I></B></FONT></FONT></FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD COLSPAN=2 WIDTH=391 HEIGHT=5>
				<P LANG="en-GB"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>Philip
				Vendil</B></FONT></FONT></P>
				<P LANG="en-GB"><BR>
				</P>
			</TD>
			<TD COLSPAN=2 WIDTH=197>
				<P LANG="zxx" ALIGN=LEFT STYLE="background: transparent"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>UNRESTRICTED</B></FONT></FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD COLSPAN=2 WIDTH=391 HEIGHT=1>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B><SPAN LANG="zxx">Godk&auml;nd
				/ </SPAN><I>Authorized</I></B></FONT></FONT></FONT></P>
			</TD>
			<TD WIDTH=115>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B><SPAN LANG="zxx">Datum
				  </SPAN><SPAN LANG="zxx"><I>Date</I></SPAN></B></FONT></FONT></FONT></P>
			</TD>
			<TD WIDTH=73>
				<P LANG="zxx" ALIGN=LEFT STYLE="margin-top: 0.04cm; background: transparent">
				<FONT COLOR="#800000"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 6pt"><B>Version</B></FONT></FONT></FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD COLSPAN=2 WIDTH=391 HEIGHT=4>
				<P LANG="en-GB"><BR>
				</P>
			</TD>
			<TD WIDTH=115>
				<P LANG="en-GB" ALIGN=LEFT><SDFIELD TYPE=DATETIME SDNUM="1053;2057;DD/MM/YY">18/01/08</SDFIELD></P>
				<P LANG="en-GB" ALIGN=LEFT><BR>
				</P>
			</TD>
			<TD WIDTH=73>
				<P LANG="zxx"><FONT FACE="Verdana, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>3.0</B></FONT></FONT></P>
			</TD>
		</TR>
	</TABLE>
	<P LANG="en-GB" CLASS="western" STYLE="margin-bottom: 0.5cm"><BR>
	</P>
</DIV>
<P ALIGN=CENTER STYLE="margin-left: 1.28cm; text-indent: 0cm; margin-top: 3.18cm; margin-bottom: 0.85cm; line-height: 0.85cm; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Verdana, sans-serif"><FONT SIZE=6 STYLE="font-size: 28pt"><B><FONT FACE="Helvetica, sans-serif"><BR></FONT></B><FONT FACE="Helvetica, sans-serif"><I><SPAN STYLE="font-weight: medium">SignServer</SPAN></I></FONT></FONT></FONT></P>
<P ALIGN=CENTER STYLE="margin-top: 3.18cm; margin-bottom: 0.85cm; font-weight: medium; line-height: 0.85cm; page-break-inside: avoid; page-break-after: avoid">
<FONT FACE="Verdana, sans-serif"><FONT SIZE=6 STYLE="font-size: 28pt">Manual</FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER><I>Ver: 3.0</I></P>
<P LANG="en-GB" ALIGN=CENTER STYLE="margin-left: 1.47cm; margin-right: 1.47cm; text-indent: 0cm; background: #ffffff; line-height: 0.85cm; page-break-inside: avoid; page-break-after: avoid">
<BR>
</P>
<P LANG="en-GB" CLASS="western">								</P>
<P LANG="sv-SE" CLASS="western"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="margin-top: 0.35cm; font-weight: medium">
     <SDFIELD TYPE=DATETIME SDNUM="1053;1053;YY-MM-DD">08-01-18</SDFIELD></P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER STYLE="font-weight: medium"><BR>
</P>
<P LANG="sv-SE" ALIGN=CENTER><BR>
</P>
<H1 LANG="en-GB" CLASS="western" STYLE="page-break-before: always">1 
Introduction/Scope</H1>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
SignServer is an application framework performing cryptographic
operations  for other applications. It's intended to be used in
environments where keys are supposed to be protected in hardware but
there isn't possible to connect such hardware to existing enterprise
applications or where the operations are considered extra sensitive
so the hardware have to protected more carefully. Another usage is to
provide a simplified method to provide signatures in different
application managed from one </FONT></FONT></FONT>location in the
company.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
SignServer have been designed for high-availability and can be
clustered for maximum</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>reliability.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
SignServer comes with a RFC 3161 compliant Time-Stamp signer serving
requests through http or client-authenticated https. A MRTD (Machine
Readable Travel Document, i.e. electronic <SPAN STYLE="font-style: normal">passport)
signer. A PDF signer that adds a signature automatically to a
uploaded document and a validation service used to lookup the
validation of a given certificate.</SPAN></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="font-style: normal">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="font-style: normal">
<FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>From version 3.0 there
also exists a mail signer framework that can be used to perform
cryptographic operation on emails. </FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal"><BR>
</P>
<P LANG="en-GB" CLASS="western"><SPAN ID="Frame1" DIR="LTR" STYLE="float: left; width: 17cm; height: 8.7cm; border: none; padding: 0cm; background: #ffffff">
	<P LANG="en-GB" ALIGN=CENTER STYLE="margin-top: 0.21cm; margin-bottom: 0.21cm">
	<IMG SRC="SignServer_Manual_3_0_odt_m6a7f442a.jpg" NAME="graphics1" ALIGN=LEFT WIDTH=100% BORDER=0><BR CLEAR=LEFT><FONT SIZE=2><I>Drawing
	1: Overview of a possible set up of a highly available SignServer
	solution</I></FONT></P>
</SPAN><BR CLEAR=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">1.1 Changes from previous versions</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">1.1.1 Changes between Version 2 and
Version 3</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western">Complete refactorisation of J2EE
	from EJB2 to EJB3 to simplify further development.</P>
	<LI><P LANG="en-GB" CLASS="western">Renamed component &ldquo;Service&rdquo;
	to &ldquo;TimedService&rdquo; since 3.0 supports other services.</P>
	<LI><P LANG="en-GB" CLASS="western">A &ldquo;TimedService&rdquo; can
	now be configured with a 'cron-like' settings to have services
	executed in other than just periodical intervals.</P>
	<LI><P LANG="en-GB" CLASS="western">A Validation Service API used to
	validate certificate from different issuers. The Validation Service
	API have it's own easy to use Web Service used to integrate with
	other platforms.</P>
	<LI><P LANG="en-GB" CLASS="western">A Group Key Service API used to
	generate and manage group keys, symmetric or asymmetric.</P>
	<LI><P LANG="en-GB" CLASS="western">Possibility to have customized
	authorization of requests, not just the built in client certificate
	authorization list.</P>
	<LI><P LANG="en-GB" CLASS="western">The name SignToken is changed to
	CryptoToken and introduced a new concept of ExtendedCryptoToken that
	supports symmetric operations.</P>
	<LI><P LANG="en-GB" CLASS="western">The RMI-SSL interface have been
	removed and replaced with a JAX-WS interface with a simple client
	framework supporting different load-balance or high availability
	policies.</P>
	<LI><P LANG="en-GB" CLASS="western">All request data have changed
	from serialization to externalization to be easier to translate to
	other platforms.</P>
	<LI><P LANG="en-GB" CLASS="western">A completely new MailSigner API
	based upon the JAMES SMTP server to perform automated cryptographic
	operations on e-mails very similar to the plug-ins for the
	SignServer.</P>
	<LI><P LANG="en-GB" CLASS="western">Java 1.4 is no longer supported.</P>
	<LI><P LANG="en-GB" CLASS="western">A lot of new JUnit tests in the
	test suite.</P>
	<LI><P LANG="en-GB" CLASS="western">A PDF Signer that can add a
	signature to a PDF document through a simple HTML interface.</P>
	<LI><P LANG="en-GB" CLASS="western">PKCS11 Crypto Token to connect
	to different PKCS11 implementations.</P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">1.1.2 Changes between Version 1 and
Version 2</H3>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>signserver_server.property
	file have been removed and replaced with a global configuration
	</FONT></FONT><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>store.</FONT></FONT></FONT></FONT></FONT></P>
</UL>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>It
	is now possible to dynamically add and remove available signers</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>A
	new type of component, &ldquo;Service&rdquo; that is run on a timely
	basis, used to perform maintenance or report generation.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Improved
	cluster deployment functionality.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="OpenSymbol"><FONT SIZE=2 STYLE="font-size: 9pt">
	</FONT></FONT></FONT></FONT></FONT>
	</P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
	<FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>New CLI tools to batch
	configure the SignServer, and to backup a current configuration.
	This makes it possible to set-up a configuration in test
	environment, dump the configuration and configure the same it in
	production.</FONT></FONT></P>
</UL>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="page-break-before: always">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<H1 LANG="en-GB" CLASS="western">2  Document History</H1>
<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=29*>
	<COL WIDTH=37*>
	<COL WIDTH=38*>
	<COL WIDTH=152*>
	<THEAD>
		<TR VALIGN=TOP>
			<TH WIDTH=11%>
				<P LANG="en-GB" CLASS="western">Version</P>
			</TH>
			<TH WIDTH=14%>
				<P LANG="en-GB" CLASS="western">Date</P>
			</TH>
			<TH WIDTH=15%>
				<P LANG="en-GB" CLASS="western">Name</P>
			</TH>
			<TH WIDTH=59%>
				<P LANG="en-GB" CLASS="western">Comment</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>0.1</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2006-06-04</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Philip Vendil</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Initial version of
				this document.</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>1.0 RC1</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2006-08-22</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Philip Vendil</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Prerelease version</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2.0</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2007-08-10</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Philip Vendil</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Update with new
				features for version 2</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2.1</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2007-09-22</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Tomas Gustavsson</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Updated with PDF
				Signer</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2.1.1</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2007-09-27</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Tomas Gustavsson</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Added PKCS11 sign
				token</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=11%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>3.0</FONT></P>
			</TD>
			<TD WIDTH=14%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>2007-01-06</FONT></P>
			</TD>
			<TD WIDTH=15%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Philip Vendil</FONT></P>
			</TD>
			<TD WIDTH=59%>
				<P LANG="en-GB" CLASS="western"><FONT SIZE=2>Big update  with 3.0
				documentation.</FONT></P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<DIV ID="Inneh&aring;llsf&ouml;rteckning1" DIR="LTR">
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P LANG="sv-SE" STYLE="margin-top: 0.42cm; margin-bottom: 0.21cm; page-break-after: avoid">
		<FONT SIZE=4><B>Table of Contents</B></FONT></P>
	</DIV>
	<P LANG="en-GB">1  Introduction/Scope	2</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">1.1
	Changes from previous versions	3</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">1.1.1
	Changes between Version 2 and Version 3	3</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">1.1.2
	Changes between Version 1 and Version 2	3</P>
	<P LANG="en-GB">2  Document History	4</P>
	<P LANG="en-GB">3  Quick start of a Simple Time-stamp Server	8</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">3.1
	Required Software	8</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">3.2
	Installation Steps	8</P>
	<P LANG="en-GB">4  Quick start of a Simple Mail Signer	10</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">4.1
	Required Software	10</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">4.2
	Installation Steps	10</P>
	<P LANG="en-GB">5  Terms Used in This Document	12</P>
	<P LANG="en-GB">6  Overall Architecture 	15</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">6.1
	SignServer	15</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">6.2
	MailSigner	16</P>
	<P LANG="en-GB">7  Available Plug-ins	17</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">7.1
	Configuring a plug-in	17</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">7.2
	SignServer Signers	17</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">7.2.1
	Time-stamp Signer	17</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.1.1
	Overview	17</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.1.2
	Available Properties	18</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">7.2.2
	MRTD Signer	19</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.2.1
	Overview	19</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.2.2
	Available Properties	19</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">7.2.3
	PDF Signer	20</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.3.1
	Overview	20</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.2.3.2
	Available Properties	20</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">7.3
	SignServer Validation Service Framework	21</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">7.3.1
	DefaultValidationService	21</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.3.1.1
	Overview	21</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.3.1.2
	Available Properties	22</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">7.4
	SignServer Group Key Service Framework	24</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.4.0.1
	Overview	24</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.4.0.2
	Available Properties	24</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">7.5
	Mail Processors	25</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">7.5.1
	SimpleMailSigner	25</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.5.1.1
	Overview	25</P>
	<P LANG="en-GB" STYLE="margin-left: 1.06cm; text-indent: 0cm">7.5.1.2
	Available Properties	25</P>
	<P LANG="en-GB">8  Available CryptoTokens	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">8.1
	P12CryptoToken	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.1.1
	Overview	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.1.2 
	Available Properties	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">8.2
	PrimeCardHSMCryptoToken	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.2.1
	Overview	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.2.2
	Available Properties	27</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">8.3
	PKCS11CryptoToken	28</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.3.1
	Overview	28</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.3.2
	Available Properties	28</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">8.3.3
	Example usage	28</P>
	<P LANG="en-GB">9  Setting Authorization Type	29</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">9.1
	SignServer	29</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">9.2
	MailSigner	29</P>
	<P LANG="en-GB">10  Disabling a Signer	29</P>
	<P LANG="en-GB">11  Archiving Responses (SignServer only)	29</P>
	<P LANG="en-GB">12  The Global Configuration Store	30</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">12.1
	SignServer specific	30</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">12.2
	MailSigner Specific	30</P>
	<P LANG="en-GB">13  Timed Services	30</P>
	<P LANG="en-GB">14  The Main WebService Interface	31</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">14.1
	Overview	31</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">14.2
	Java Client API	31</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">14.2.1
	Load Balance Policies	32</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">14.2.2
	CLI Client 	32</P>
	<P LANG="en-GB">15  Building and Deploying the SignServer or
	MailSigner	33</P>
	<P LANG="en-GB">16  Administrating the SignServer	34</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">16.1
	General Commands	34</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">16.2
	SignServer Specific Commands	36</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">16.2.1
	Authorization Related	36</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">16.2.2
	Database Related	36</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">16.2.3
	Archive Related	37</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">16.2.4
	Group Key Service Related	37</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">16.3
	MailSigner Specific Commands	38</P>
	<P LANG="en-GB">17  Making the SignServer highly-available	39</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">17.1
	HTTP access requires a load balancer	39</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">17.2
	Setting up a MySQL Cluster	39</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">17.3
	MailSigner	39</P>
	<P LANG="en-GB">18  For Developers	40</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">18.1
	Building with Customized Code	40</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">18.2
	Implementing Workers	40</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.2.1
	The ISigner Interface	41</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.2.2
	The ITimedService Interface	41</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.2.3
	IValidationService Interface	42</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.2.4
	IGroupKeyService Interface	42</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.2.5
	IMailProcessor Interface	44</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">18.3
	Implementing Crypto Tokens	44</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.3.1
	The ICryptoToken Interface	44</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.3.2
	The Extended Crypto Token Interface	46</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">18.4
	Other Customizations	47</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.4.1
	The IValidator Interface	47</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">18.4.2
	The IAuthorizer Interface	48</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">18.5
	Using the Global Configuration Store	49</P>
	<P LANG="en-GB">19  Testing	50</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">19.1
	Automatic Junit Tests	50</P>
	<P LANG="en-GB" STYLE="margin-left: 0.35cm; text-indent: 0cm">19.2Testing
	the TimeStamp Authority	50</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">19.2.1
	The TSA Test Client	50</P>
	<P LANG="en-GB" STYLE="margin-left: 0.71cm; text-indent: 0cm">19.2.2
	Manual Tests	50</P>
	<P LANG="en-GB">20  References	51</P>
</DIV>
<H1 LANG="en-GB" CLASS="western" STYLE="page-break-before: always">3 
Quick start of a Simple Time-stamp Server</H1>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>This
section will show how to set up a quick and simple standalone
time-stamp server, accepting</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>time-stamp
requests over plain HTTP.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<H2 LANG="en-GB" CLASS="western">3.1 Required Software</SPAN></H2>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Java
	1.6 (or 1.5) (http://java.sun.com)</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>JBoss-4.2.2.GA
	(http://www.jboss.org)</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Ant
	version 1.7 (http://ant.apache.org)</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>SignServer-3.0
	(</FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>http://www.signserver.org</FONT></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>)</FONT></FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1
	web-server key-store in Java key-store format (JKS), (make sure that
	the server certificate have the right host name in it's CN, optional
	(used for HTTPS))</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1
	Root certificate of the web-server in DER encoding (<FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>optional
	(used for HTTPS)).</FONT></FONT></FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1
	Time-stamp key-store in PKCS12 format<BR></FONT></FONT><BR>
	</P>
</UL>
<H2 LANG="en-GB" CLASS="western">3.2 Installation Steps</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1.
First make sure that ant, Java and JBoss is installed properly.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>2.
Set the JAVA_HOME, JBOSS_HOME and SIGNSERVER_HOME environment
variables.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>3.
Set the SIGNSERVER_NODEID environment variable, it should be a server
unique string</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>identifying
the node in a cluster. (optional for one node installations).<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>4.
Unzip the SignServer package and go to it's home directory.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>5.
If you are going to protect the HTTP communication with SSL, you need
a JKS SSL server</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>key
store. Rename the web server key store to tomcat.jks at put it in a
'p12' subdirectory.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Also
place the web server root certificate in DER encoding in the same
directory, call it</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>rootcert.cer</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>6.
Then copy the signserver_build.properties.sample file to
signserver_buld.properties and edit</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>the
file. At least configure the httpsserver.password property. If you
are not using https</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>uncomment
the row &ldquo;</FONT></FONT><FONT FACE="CourierNewPSMT">j2ee.web-nohttps=</FONT><FONT COLOR="#2a00ff"><FONT FACE="CourierNewPSMT">true&rdquo;.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>7.
Do 'ant deploy' and then start JBoss (JBOSS_HOME\bin\run.sh) in
another console.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>8.
Edit the signserver_cli.properties and set the host name.*
properties.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>9.
Edit the sample-configs/qs_timestamp_configuration.properties file
and set the default policy id, the path to </FONT></FONT></FONT>the
timestamp p12 file and its password.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>10.
Use the signserver cli to upload the configuration file. (if it's not
executive use chmod +x bin/signserver.sh) </FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><BR></FONT></FONT>bin/signserver.sh
setproperties sample-configs/ qs_timestamp_configuration.properties</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>(In
the path section, use '\\' for '\' in windows environment.)</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Then
run</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>bin/signserver.sh
getconfig 1</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Or
you could use the signers name</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>bin/signserver.sh
getconfig timestampSigner</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>And
double check the configuration. (Important, the properties are case
sensitive).</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Finally
run</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>bin/signserver.sh
reload 1</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>To
activate the configuration.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>11.
Run the test-client to see that everything is up.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>cd
dist-client</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="CourierNewPSMT">java
-jar timeStampClient.jar
&ldquo;</FONT><FONT COLOR="#0000ff"><FONT FACE="CourierNewPSMT">http://localhost:8080/signserver/tsa?signerId=1</FONT></FONT><FONT FACE="CourierNewPSMT">&rdquo;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>`</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
message &ldquo;TimeStampRequest Validated&rdquo; should appear once a
second.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Also
check JBOSS_HOME/server/default/log/server.log that successful
messages appear.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H1 LANG="en-GB" CLASS="western" STYLE="page-break-before: always">4 
Quick start of a Simple Mail Signer</H1>
<P LANG="en-GB" CLASS="western">This section will do a fast and
minimal configuration of a Mail Signer that will sign all authorized
mails sent through it with a PKCS12 cryptographic token.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">4.1 Required Software</SPAN></H2>
<UL>
	<LI VALUE=1><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Java
	1.6 (or 1.5) (http://java.sun.com)</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Ant
	version 1.7 (http://ant.apache.org)</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>SignServer-3.0
	(</FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>http://www.signserver.org</FONT></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>)</FONT></FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1
	mail signing key-store in PKCS12 format (The key store should have a
	RFC822Name that matches the sender address that will be replaces by
	the Simple Mail Signer plug-in). There exists one keystore in
	src/test/mailsigner_test1.p12 with a RFC822Name of
	<A HREF="mailto:mailsigner@someorg.org"></A><A HREF="mailto:mailsigner@someorg.org"></A><A HREF="mailto:mailsigner@someorg.org"><FONT COLOR="#000000"><I><SPAN STYLE="text-decoration: none"><SPAN STYLE="font-weight: medium">mailsigner@someorg.org</SPAN></SPAN></I></FONT></A><A HREF="mailto:mailsigner@someorg.org"></A><A HREF="mailto:mailsigner@someorg.org"></A>
	that can be used for testing.</FONT></FONT></P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">4.2 Installation Steps</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>1.
First make sure that Ant and Java is installed properly.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>2.
Set the JAVA_HOME and SIGNSERVER_HOME environment variables.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>3.
Set the SIGNSERVER_NODEID environment variable, it should be a server
unique string</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>identifying
the node in a cluster. (optional for one node installations).<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>4.
Unzip the SignServer package and go to it's home directory.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>5.
Then copy the signserver_build.properties.sample file to
signserver_buld.properties and edit</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000">the
file. First uncomment row &ldquo;</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=2>build.mode=MAILSIGNER</FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>&rdquo;</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>
to instruct that this installation is a MailSigner and not a
SignServer. Then go to the end of the file and fill in the required
properties: </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>mailsigner.primarydns</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>,
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>mailsigner.secondarydns
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>and</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
mailsigner.postmaster.</FONT></FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>6.
Then build the mail signer with the command 'ant' in the
SIGNSERVER_HOME directory.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>7.
Edit the sample-configs/qs_simplemailsigner_configuration.properties
file and set the sender and from addresses as well as the path and
password to the cryptographic token that should be used.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><BR>8.
Start the mail signer application with the command: </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>ant
run<BR></FONT></FONT></FONT></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Times New Roman, serif"><FONT SIZE=3><FONT COLOR="#000000">9.</FONT><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>
Open up another console, go to SIGNSERVER_HOME and use the signserver
CLI to upload the configuration file. (if it's not executive use
chmod +x bin/signserver.sh) </FONT></FONT></FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><BR></FONT></FONT></FONT><FONT COLOR="#000000">bin/signserver.sh
setproperties sample-configs/
qs_simplemailsigner_configuration.properties</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Then
run</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>bin/signserver.sh
getconfig 1</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Finally
run</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=2>bin/signserver.sh
reload 1</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>To
activate the configuration.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>19.
<FONT COLOR="#000000">Finally add an authorized SMTP user with the
command:<BR>bin/signserver.sh addauthorizeduser &lt;username&gt;
&lt;password&gt;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><BR>20.
Now is the simple mail signer ready to be used for signing outgoing
emails. Configure you e-mail client to connect to the MailSigner
server using the username and password you just provided and send a
mail to a colleague to verify it is signed properly.</FONT></FONT></P>
<H1 LANG="en-GB" CLASS="western" STYLE="page-break-before: always">5 
Terms Used in This Document</H1>
<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=128*>
	<COL WIDTH=128*>
	<THEAD>
		<TR VALIGN=TOP>
			<TH WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Term</P>
			</TH>
			<TH WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Explanation</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Signer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Processable service performing
				signatures upon requests. This could be a ready made signer or a
				custom developed one.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Crypto Token (former Sign Token)</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Crypto Token is a name for the
				entity containing the private key and is responsible for its
				cryptographic operations. Every Processable have a Crypto Token
				that can be a PKCS12, Smart Card or HSM connection.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Extended Crypto Token</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">An enhanced Crypto Token with
				support for symmetric key operations.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50% HEIGHT=16>
				<P LANG="en-GB" CLASS="western">PKCS11CryptoToken</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Crypto Token able to
				communicate with Hardware Security Modules through the standard
				PKCS11 interface.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">TimedService (former Service)</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A TimedService is a task that is
				run on a timely basis, performing maintenance tasks like changing
				active key or generate a report.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Worker</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A common name for Processable
				(Signer or other type of service), Mail Processor and
				TimedService</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Processable</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A type of worker that is used to
				process requests, i.e. not a TimedService.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Worker Configuration</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Each Worker can be configured
				with properties specific for that worker. There are two sets of
				worker configuration one &ldquo;Active&rdquo; that is used by the
				signer and one &ldquo;current&rdquo; which is the one configured
				by the administrator. The current configuration isn't used in
				production until the administrator issued the reload command.
				This makes it possible for the administrator to configure
				multiple properties and double-check them before they are
				actually used.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Global Configuration Store</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Is a dynamic store used to define
				available Workers and their Crypto Tokens. But other data that
				needs to be read globally could be set there as well. The global
				configuration properties are activated immediately. There are two
				different scopes for the store data, Global Scope and Node Scope.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Global Scope</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Data stored in the global
				configuration that can be read by all nodes in the cluster.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Node Scope</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Data that is node specific and
				can only be read within the same node.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Worker Id</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Unique identifier of a worker, an
				integer larger than 0</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Worker Name</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A name used as a human readable
				synonym for a Worker Id</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Mail Processor</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A plug-in used for the mail
				signer to perform automated cryptographic operations on e-mails
				sent through the mail server. This could for instance be the
				Simple Mail Signer for attaching a SMIME signature to all mails.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Validation Service 
				</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Processable that checks if a
				certificate is valid or not. Have a Default Validation Service
				implementation that should work in most cases.</P>
				<P LANG="en-GB" CLASS="western">A Validation Service should have
				one or more Validators configured.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Group Key Service</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Processable that can be used to
				manage, generate and distribute group keys to a set of clients.
				The service support four types of calls, fetch group key (used by
				clients), pre-generate group keys, switch encryption key (key
				used to safely store the group keys in database) and remove group
				keys.  There exists a Default Group Key Service that should
				satisfy most use cases.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Validator</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Validator is responsible for
				checking the status of one or more issuer's certificates. This
				could be as a OCSP client or a CRL checker or just looking up the
				status in a database.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Authorizer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">An interface that enables
				developers to integrate the authorization parts with existing
				authorization systems of who is authorized to perform requests to
				a Processable.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Time Stamp Signer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Signer that can be used to set
				up a Timestamp Authority according to RFC 3161. 
				</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">MRTD Signer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Signer that performs signatures
				of MRTD (Machine Readable Travel Documents, i.e. Electronic
				Passports) blobs.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">PDF Signer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Signer that attaches an
				electronic signature signature to a PDF document.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Simple Mail Signer</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western">A Mail Processor that envelopes
				authorized mails with a SMIME signature.</P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">6  Overall Architecture 
</H1>
<P LANG="en-GB" CLASS="western">In the 3.0 version the SignServer
project have two different builds, one is the classical SignServer
and the other is a Mail Processing Server called the MailSigner. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">6.1 SignServer</SPAN></H2>
<P LANG="en-GB" CLASS="western">The SignServer is a framework
designed to perform different kind of cryptographic operations for
different applications. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">In the 3.0 version there are three
kind of processable services. Signers (used to sign or in other way 
process requested data). Validation Services used to verify the
validity of a certificate against a set of backed issuers. The
validation service can be used to simply the integration of PKIs into
existing applications. The the third processable service is a group
key service framework used to manage and to distribute group keys for
different applications, these keys can be both symmetric and
asymmetric. In addition to processable services there also exists
another concept called Timed Service (called just 'service' in 2.0
edition) which are plug-ins run at defined intervals performing
maintenance or reporting routines.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Out-of-the-box are there three
Signers ready to be used. They are a MRTD Signer used for signing
Machine Readable Travel Documents (also known as Electronic
Passports), a Timestamp Signer that can be used to set up a Timestamp
Authority and a PDF signer that can be used to automatically sign
documents. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The main way of communicating with
the SignServer is through a WebService interface (previous versions
had a RMI-SSL interface, but that have been replaced by the WS for
better platform independence.) but the Timestamp Signer is also
available through HTTP communication and the PDF signer have a simple
HTML page that allows users to upload documents to be signed.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">For an overview of the different
concepts in the SignServer see illustration 1. The base component is
called Worker which is assigned an id, optionally a name and a
configuration. A sub component is a Processable which receives and
processes requests. A Processable (optionally) have access to a
cryptographic token (CryptoToken) in charge of managing the keys of a
Processable. A CryptoToken can be either software or hardware based.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The applications i administrated
through a command-line interface, where the properties and access
control can be configured.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">One SignServer can have multiple
services for different purposes.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">6.2 MailSigner</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner is a different build
of the SignServer, targeted to perform automated cryptographic
operations on e-mails. The MailSigner is an add-on to the James SMTP
project and the James SMTP binaries is shipped along with the
SignServer package for simplified set-up.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner's main component is
the MailProcessor which is the base for all MailSigner plug-ins.
There exists one ready to use MailSigner called the SimpleMailSigner.
It generates a signed SMIME message of all mails sent to through the
server.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">One instance can have more than one
MailProcessor configured. Then will the plug-ins be called by worker
id in ascending order.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner have similar CLI
interface and is administrated much in the same way as the
SignServer. The SMTP server have support for SMTP Authentication. For
more information about the James SMTP server see
<A HREF="http://james.apache.org/"></A><A HREF="http://james.apache.org/"></A><A HREF="http://james.apache.org/">http://james.apache.org</A><A HREF="http://james.apache.org/"></A><A HREF="http://james.apache.org/"></A>
.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><SPAN ID="Ram1" DIR="LTR" STYLE="float: left; width: 17cm; height: 6.46cm; border: none; padding: 0cm; background: #ffffff">
	<P LANG="en-GB" ALIGN=CENTER STYLE="margin-top: 0.21cm; margin-bottom: 0.21cm">
	<IMG SRC="SignServer_Manual_3_0_odt_18c42972.png" NAME="grafik1" ALIGN=LEFT WIDTH=100% BORDER=0><BR CLEAR=LEFT><FONT SIZE=2><I>Illustration
	1: Components in the SignServer project</I></FONT></P>
</SPAN><BR CLEAR=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">7  Available Plug-ins</H1>
<H2 LANG="en-GB" CLASS="western">7.1 Configuring a plug-in</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">A worker component is configured by
entering its class path (and optionally its crypto token class path) 
in a memory bank called the global configuration and then issuing the
reload command. There exists sample configurations for most of the
plug-ins in the 'sample-configs' directory.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">7.2 SignServer Signers</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">There currently exists three types of
signers. The first one is the time stamp signer generating RFC 3161
compliant timestamps using the Bouncycastle library. A MRTD signer
creating 'Machine Reader Travel Document' signatures using the RSA
algorithm from pre-padded data. The final signer is a PDF Signer used
for automatically signed requested PDF documents.</P>
<H3 LANG="en-GB" CLASS="western"></H3>
<H3 LANG="en-GB" CLASS="western">7.2.1 Time-stamp Signer</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The time-stamp signer have the class
path: org.signserver.server.signers.TimeStampSigner</P>
<H4 LANG="en-GB" CLASS="western">7.2.1.1 Overview</H4>
<P LANG="en-GB" CLASS="western">The time stamp server generates time
stamp tokens and have the support for the following options:</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western">Set of accepted policies</P>
	<LI><P LANG="en-GB" CLASS="western">Set of accepted algorithms</P>
	<LI><P LANG="en-GB" CLASS="western">Set of accepted extensions</P>
	<LI><P LANG="en-GB" CLASS="western">Accuracy microseconds</P>
	<LI><P LANG="en-GB" CLASS="western">Accuracy milliseconds</P>
	<LI><P LANG="en-GB" CLASS="western">Accuracy seconds</P>
	<LI><P LANG="en-GB" CLASS="western">Included certificate chain
	(currently doesn't include CRLs)</P>
	<LI><P LANG="en-GB" CLASS="western">Ordering</P>
	<LI><P LANG="en-GB" CLASS="western">TSA name</P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The time stamp signer currently don't
support:</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western">CRL inclusion</P>
	<LI><P LANG="en-GB" CLASS="western">Signed attributes</P>
	<LI><P LANG="en-GB" CLASS="western">Unsigned attributes 
	</P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Timestamps requests are served
through a http service at the URL: 
</P>
<P LANG="en-GB" CLASS="western">'http://&lt;host
name&gt;/signserver/tsa?signerId=&lt;worker Id&gt;'</P>
<P LANG="en-GB" CLASS="western">If no 'worker Id' parameter is
specified then will the id of 1 be used as default.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The time-stamp signer requires a
time-stamp certificate with the extended key usage 'time-stamp' only.
The extended key usage extension must be critical.</P>
<H4 LANG="en-GB" CLASS="western">7.2.1.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The following properties can be
configured with the signer:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>TIMESOURCE</B></I>
= property containing the class path to the ITimeSource
implementation that should be used. (OPTIONAL, default
LocalComputerTimeSource)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCEPTEDALGORITHMS</B></I>
= A ';' separated string containing accepted algorithms, can be null
if it shouldn't be used. (OPTIONAL, Strongly recommended)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 2.54cm">Supported
Algorithms are: <I>GOST3411, MD5, SHA1, SHA224, SHA256, SHA384,
SHA512, RIPEMD128, RIPEMD160, RIPEMD256</I></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCEPTEDPOLICIES</B></I>
=  A ';' separated string containing accepted policies, can be null
if it shouldn't be used. (OPTIONAL, Recommended)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCEPTEDEXTENSIONS</B></I>
= A ';' separated string containing accepted extensions, can be null
if it shouldn't be used. (OPTIONAL)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>DEFAULTTSAPOLICYOID</B></I>
= The default policy ID of the time stamp authority (REQUIRED, if no
policy OID is specified in the request then will this value be used.)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCURACYMICROS</B></I>
= Accuracy in micro seconds, Only decimal number format, only one of
the accuracy properties should be set (OPTIONAL)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCURACYMILLIS</B></I>
= Accuracy in milliseconds, Only decimal number format, only one of
the accuracy properties should be set (OPTIONAL)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ACCURACYSECONDS</B></I>
= Accuracy in seconds. Only decimal number format, only one of the
accuracy properties should be set (OPTIONAL)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ORDERING</B></I>
= The ordering (OPTIONAL), default false.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>TSA</B></I>
= General name of the Time Stamp Authority. (OPTIONAL)</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">7.2.2 MRTD Signer</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MRTD signer have the class path:
org.signserver.server.signers.MRTDSigner</P>
<H4 LANG="en-GB" CLASS="western">7.2.2.1 Overview</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MRTD Signer performs a RSA
signing operation on incoming data. The data should already be
padded. This signer i used to sign 'Machine Readable Travel
Documents' i.e. electronic passports.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H4 LANG="en-GB" CLASS="western">7.2.2.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">No configuration properties exists.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">7.2.3 PDF Signer</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PDF signer have the class path:
org.signserver.server.signers.PDFSigner</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H4 LANG="en-GB" CLASS="western">7.2.3.1 Overview</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PDF signer signs PDF files and
have the support for the following options:</P>
<UL>
	<LI VALUE=1><P LANG="en-GB" CLASS="western">Reason</P>
	<LI><P LANG="en-GB" CLASS="western">Location</P>
	<LI><P LANG="en-GB" CLASS="western">Rectangle</P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PDF signer currently don't
support:</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western">Inclusion of time stamps in the
	signature</P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">PDF signing requests are served
through a http service at the URL: 
</P>
<P LANG="en-GB" CLASS="western">'http://&lt;host
name&gt;/signserver/pdf?signerId=&lt;worker Id&gt;'</P>
<P LANG="en-GB" CLASS="western">If no 'worker Id' parameter is
specified then will the id of 1 be used as default.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PDF signer requires a signing
keystore with a signing certificate.</P>
<H4 LANG="en-GB" CLASS="western">7.2.3.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The following properties can be
configured with the signer:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>REASON</B></I>
= The reason included in the PDF signature and displayed by the PDF
reader. Default value is &ldquo;Signed by SignServer&rdquo;.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>LOCATION</B></I>
= The location included in the PDF signature and displayed by the PDF
reader. Default value is &ldquo;SignServer&rdquo;.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>RECTANGLE</B></I>
= The coordinates and size of the visible signature field added to
the PDF file. Has the form &ldquo;llx,lly,uux,uuy&rdquo;, where llx
is lower left x coordinate etc.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">7.3 SignServer Validation Service
Framework</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The validation service framework is
used to validate certificates from one or more issuers. It can be
used to  have one central point of performing revokation statuses to
simplify the integration of external PKIs within an enterprise. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The validation service framework also
provides a validation cache that can be used to increase performance
for those cases a application does multiple lookups of the same
certificate within a short period of time. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Out-of-the-Box there exists a
DefaultValidationService that should satisfy most use cases but it's
possible to develop a custom ValidationService if necessary. See the
developer section for more details.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">All Validation Services is configured
by specifying the
<FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>org.signserver.validationservice.server.ValidationServiceWorker
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>in
the global configuration, then is the actual ValidationService
configured in the worker configuration setting the class path in the
property </FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>TYPE
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>(Not
necessary for the DefaultValidationService).</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>The
validation service framework is mostly used with X509v3 certificates
but other kinds of certificates is supported as well by design.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Another
concept in the Validation Service Framework is that the client also
can ask the service to check the type of certificate that the
certificate might be used for. A certificate type could be
IDENTIFICATION or ELECTRONIC SIGNATURE.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">7.3.1 DefaultValidationService</H3>
<H4 LANG="en-GB" CLASS="western">7.3.1.1 Overview</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The default validation service have a
set of Validators. A validator is responsible to checking the
validity against one or more issuers using for example CRL check or
OCSP/XKMS lookup or just by checking some database. Currently there
are no ready to use validators, these remain to be developed in
future versions of the SignServer.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The Default Validation Service
supports validations to be cached for some or all issuers for a
specified amount of time. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">If not configured otherwise will the
validation service use the DefaultX509CertTypeChecker that determines
the certificate type from the key usage in the certificate.  Key
Encipherment and Digital Signature indicates a IDENTIFICATION type
and Non-reputation indicates ELECTRONIC SIGNATURE. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">There exists a validation specific
WebService that can be used for platform independent client calls.</P>
<P LANG="en-GB" CLASS="western">The WebService must be enabled during
the build and isn't by default. The WebService WSDL file is located
at the URL
<A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="text-decoration: none">http://&lt;hostname&gt;:8080/signserver/validationws/validationws?wsdl
</SPAN></FONT></FONT></FONT></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="text-decoration: none">and
it contains two calls one is 'isValid' that performs the validation
check and the other is a getStatus call that checks the health of the
node and its underlying systems. The last calls can be used by
clients for monitoring or implementing redundancy.</SPAN></FONT></FONT></FONT></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"></A></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Important</I>, Due to class path
conflict in JBoss 4.2.x own JBoss WebService stack and the JAX-WS
stack used by the SignServer must the JBoss WebService stack be
removed before the WebService is used. This is done by going to
JBOSS_HOME/server/default/deploy and remove the directory
jbossws.sar.</P>
<H4 LANG="en-GB" CLASS="western">7.3.1.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The following properties can be
configured with the default validation service:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The validation service have three
types of properties, general properties (that applies for the service
and all configured validators), validator properties (that only
applies for a specific validator) and issuer properties (that only
applies for an issuer configured in a specific validator).</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>General Properties:</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>CACHEDISSUERS</B></I>
= A ';' separated list of issuer names (usually issuer DNs) 
(Optional, no validation is cached if unset.)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>CERTTYPECHECKER</B></I>
= Certificate type checker that should be used to determine the type
of certificate (Optional, default is
<FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>org.signserver.validationservice.server.DefaultX509CertTypeChecker)</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>TIMEINCACHE</B></I>
= Time in seconds a certificates validation should be cached
(Optional, default is 10 seconds)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Validator properties:</I></P>
<P LANG="en-GB" CLASS="western"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Validator
properties is specified with the prefix of '</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>validator&lt;validatorId&gt;.'
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>or</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>
'val&lt;validatorId&gt;.</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>'
were validator Id should be an integer between 1 and 255. For
instance, to specify the type of a validator with an id of 1 then
specify 'val1.classpath=some.classpath.SomeClass'. This validator
will be initialized with all its validator specific properties (with
'val&lt;id&gt;.' prefix removed) as well as the general ones.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><I><B>CLASSPATH</B></I></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>
= Class path to the validator that should be used. (Required for each
configured validator)</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Issuer
properties: </FONT></FONT></FONT></I><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal">
Issuer properties are specified as 'val&lt;val id&gt;.issuer&lt;issuer
id&gt;.&lt;property&gt;' were issuer id is a positive integer between
1 and 255. All generic and validator specific properties (with the
given validator id) will also be propagated to the specific issuer
configuration.</SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><I><B>CERTCHAIN</B></I></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>
= The certificate path of the CA certificates used to verify the
certificate. Should be a appended BASE64 string. (Required for each
configured issuer).</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>Here
is an example configuration of a validation service to clarify things
even further </FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>#
Set up the worker -&gt; validation service wrapper</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>GLOB.WORKER1.CLASSPATH=</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>org.signserver.validationservice
.server.ValidationServiceWorker</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#Uncomment
and set class path to custom validation service, othervise is default
#used.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#WORKER1.TYPE=</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#
Name of Service (Optional)</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.NAME=ValidationService1</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#
Define TestCA2 and TestCA3 as a cached for 15 seconds, TestCA1 is Not
cached.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.CACHEDISSUERS=CN=TestCA2;CN=TestCA3</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.TIMEINCACHE=15</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#
Define a validator in charge of issuer TestCA1 and TestCA2</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.VAL1.CLASSPATH=&lt;Class
path to some validator&gt;</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.VAL1.ISSUER1.CERTCHAIN=EFWAASDFADFASDFKASDKFW1231.....</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.VAL1.ISSUER2.CERTCHAIN=EFWAASDFADFASDFKASDKFW1231.....</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>#
Define a validator in charge of issuer TestCA3</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.VAL2.CLASSPATH=&lt;Class
path to some validator&gt;</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>WORKER1.VAL2.ISSUER1.CERTCHAIN=EFWAASDFADFASDFKASDKFW1231.....</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">7.4 SignServer Group Key Service
Framework</SPAN></H2>
<H4 LANG="en-GB" CLASS="western">7.4.0.1 Overview</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The group key service framework is
used to manage and distribute group keys to clients in an
organisation. The keys can be generated on demand or pre-generated at
times when the system is not utilized a lot. The group keys can be
both symmetric and asymmetric but one service can only distribute one
type of key. If several kinds of keys are required should multiple
services be set up within the same server.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The group keys are stored encrypted
in database. The encryption key can be configured to be switched
automatically after a defined number of encryptions to avoid
overexposure of the cryptographic data. It is also possible to switch
the encryption key manually.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The Framework requires an
ExtendedCryptoToken, the difference are that the extended token have
additional support for key export and symmetric key operations.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The Group Key Service have CLI
commands for administration of the service such as pre-generate keys,
manual switch of encryption key and removal of group keys.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The communication to the group key
service is mainly done through the main Web Service interface. But
other ways of communicating with the server might come in the future.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Authorization to group keys is very
important and therefore should a special plug-in be developed  that
looks up which clients that should have access to a specific group
key which fit into the organisation needs. See the authorization
chapter of how to develop a customized authorization plug-in.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The basic configuration of a group
key service is very similar to that of a validation service. Two
entries is required in the global configuration. The first is the
class path for the Worker to GroupKeyService wrapper, then a class
path reference to the extended crypto token used with the service. If
not the default group key service should be used it is possible to
define a custom one by specifying its class path in the TYPE worker
property.</P>
<H4 LANG="en-GB" CLASS="western">7.4.0.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>USEPREGENERATION</B></I>
= Setting defining of keys should be pre-generated or generated on
the fly when needed. If the pool of pre-generated keys gets empty
will new keys always be generated automatically. (Optional, default
is true)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ENCKEYALG</B></I>
=  Encryption algorithm used to encrypt the group keys stored in
database. ( Optional, default is &ldquo;AES&rdquo;)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>ENCKEYSPEC</B></I>
= Specification of the encryption key. (Optional, default is &ldquo;256&rdquo;)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>GROUPKEYALG</B></I>
=  Defines the type of group keys that this service should generate (
Optional, default is &ldquo;AES&rdquo;)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>GROUPKEYSPEC</B></I>
= Specification of the generated group keys. (Optional, default is
&ldquo;256&rdquo;)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>KEYSWITCHTHRESHOLD</B></I>
= Setting defining the number of group keys that should be  encrypted
by the same encryption key before it's switched. (Optional, default
is 100000)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">7.5 Mail Processors</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">This section lists the available
plug-ins for the MailSigner. These plug-ins are configured in the
exact same way with class path of both plug-in and its crypto token.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">7.5.1 SimpleMailSigner</H3>
<H4 LANG="en-GB" CLASS="western">7.5.1.1 Overview</H4>
<P LANG="en-GB" CLASS="western">The SimpleMailSigner is a plug-in
that generates a signed SMIME message from any authorized mail sent
through the MailSigner server. It can be used prove the origin of the
message to the receivers .</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">There exists a demo configuration in
the 'sample-configs' directory.</P>
<H4 LANG="en-GB" CLASS="western">7.5.1.2 Available Properties</H4>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>EXPLAINATIONTEXT
 =</B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
 Text attached to the e-mail describing the signature for the
recipient. (Optional)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>USEREBUILDFROM
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Setting
indicating if the from field of the SMIME should be altered.</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#3f5fbf"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
</SPAN></SPAN></FONT></FONT></FONT>(Optional, default is true)</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>SIGNATUREALG
 = </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Setting
configuring the signature algorithm that should be used in the SMIME
message.</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#3f5fbf"><FONT FACE="Courier New, monospace"><FONT SIZE=2><I><B>
</B></I></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">(Optional,
default is </SPAN></SPAN></SPAN></FONT></FONT></FONT>DIGEST_SHA1<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; font-style: normal; font-weight: medium; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>POSTMASTERSIGNS
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Indicates
if postmaster mail should be signed.</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#3f5fbf"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">(Optional,
default is false)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>FROMADDRESS</B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><I><B>
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">The
from email address used if rebuild from is set. </SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">(Required
if USEREBUILDFROM is true)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; font-style: normal; font-weight: medium; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>FROMNAME
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Readable
name used in from address field. (Optional)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>CHANGEREPLYTO
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Indicates
if the reply-to field should be altered to </SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">the
original sender. (Optional, default is false)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>REPLYTOADDRESS
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">The
reply to email address if the reply always should be changed to</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; font-style: normal; font-weight: medium; widows: 2; orphans: 2">
<FONT FACE="Times New Roman, serif"><FONT SIZE=3>a default address.
(Required if CHANGEREPLYTO is true)</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; font-style: normal; font-weight: medium; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>REPLYTONAME
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Readable
name used in reply-to address field. (Optional)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>SIGNERADDRESS
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">The
email address that should be in the sender field. (Required)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
 
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>SIGNERNAME
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Readable
name used in sender address field. (Optional)</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>REQUIRESMTPAUTH
= </B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Setting
defining if SMTP AUTH should be required to</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; font-style: normal; font-weight: medium; widows: 2; orphans: 2">
<FONT FACE="Times New Roman, serif"><FONT SIZE=3>sign the mail.
(Default is true).</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">8  Available CryptoTokens</H1>
<P LANG="en-GB" CLASS="western">There exists three types of crypto
tokens (Formerly known as sign tokens), one storing the keys in
software, one general for communicating with cryptographic hardware
through the PKCS11 interface and one for SmartCards. See the
developer section for information about developing support for other
HSMs.</P>
<H2 LANG="en-GB" CLASS="western">8.1 P12CryptoToken</SPAN></H2>
<P LANG="en-GB" CLASS="western">The P12CryptoToken signer have the
class path: org.signserver.server.cryptotokens.P12CryptoToken</P>
<H3 LANG="en-GB" CLASS="western">8.1.1 Overview</H3>
<P LANG="en-GB" CLASS="western">A CryptoToken using a PKCS 12
key-store in the file-system. Can only contain one signing key.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">In a clustered environment must the
key store be at the same location at all nodes.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The P12CryptoToken, doesn't support
the destroyKey() method</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">8.1.2  Available Properties</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm">
<I><B>KEYSTOREPATH</B></I> : The full path to the key-store to load.
(required)</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>KEYSTOREPASSWORD</B></I>
: The password that locks the key-store. Used for automatic
activation.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">8.2 PrimeCardHSMCryptoToken</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">8.2.1 Overview</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Using PrimeCardHSM it's possible to
use a SmartCard to generate 2048-bit RSA signatures. The SmartCard
can perform about one signature a second. PrimeCardHSM is proprietary
software by PrimeKey Solutions AB.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">PrimeCardHSM requires PCSCD software
and SmartCard drivers. See separate documentation about installing
PrimeCardHSM.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PrimeCardHSMCryptoToken, doesn't
support the destroyKey() method.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PrimeCardHSMCryptoToken signer
have the class path:
org.signserver.server.cryptotokens.PrimeCardHSMCryptoToken</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">8.2.2 Available Properties</H3>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>DEFAULTKEY
=  </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
Hash value of the signing key on the card. See PrimeCardHSM
documentation for more information.(Required)</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>AUTHCODE
= </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Authentication
code for automatic activation (Optional).</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<H2 LANG="en-GB" CLASS="western">8.3 PKCS11CryptoToken</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">8.3.1 Overview</H3>
<P LANG="en-GB" CLASS="western">Using PKCS11 it's possible to use a
HSM that has a PKCS11 module, such as Utimaco, nCipher or Eracom.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The PKCS11CryptoToken have the class
path: org.signserver.server.cryptortokens.PKCS11CryptoToken</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">8.3.2 Available Properties</H3>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>DEFAULTKEY
=  </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
Hash value of the signing key on the card. (Required)</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>PIN
=  </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
Authentication code for activation. (Required)</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>SHAREDLIBRARY
=  </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
Full path to the library containing the PKCS11 interface. (Required)</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>SLOT
=  </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
Slot to use (Required)</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<H3 LANG="en-GB" CLASS="western" STYLE="font-weight: medium"><I>8.3.3
Example usage</I></H3>
<P LANG="en-GB" CLASS="western">Edit
qs_pdfsigner_configuration.properties and choose the sign token
setting for the PKCS11 sign token. Run the following command to set
up a PDF signer using the PKCS11 properties configured:</P>
<P LANG="en-GB" CLASS="western"><I>bin/signserver.sh setproperties
qs_pdfsigner_configuration.properties</I></P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium">You also
need a certificate for the signer. Generate a certificate request
with the command:</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium"><I>bin/signserver.sh
generatecertreq 8 &quot;CN=PKCS11 Signer token&quot; SHA1WithRSA
/tmp/certreq.pem</I></P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium">Add a
user in EJBCA with a certificate profile suitable for signing, and
enrol for a &ldquo;Server Certificate&rdquo; using the public web
pages. 
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium">Create
the certificate chain file with the command:</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
cat /tmp/cert.pem /tmp/AdminCA1.pem &gt; /tmp/certchain.pem</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
The signer certificate must be first, and the root CA certificate
last.</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-weight: medium">Upload
the signing certificate chain to the signer using the command:</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
bin/signserver.sh uploadsignercertificatechain 8 GLOB
/tmp/certchain.pem</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
After the certificate chain has been uploaded to the server, the
configuration must be reloaded and the server must be restarted. It
is not sufficient to only reload the configuration.</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<H1 LANG="en-GB" CLASS="western" STYLE="page-break-before: always">9 
Setting Authorization Type</H1>
<H2 LANG="en-GB" CLASS="western">9.1 SignServer</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">By default is client-certificate
authentication required for a signature request to be processed. This
can be changed with the <I><B>AUTHTYPE</B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
property. </SPAN></SPAN>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>AUTHTYPE</B></I></SPAN></FONT></FONT></FONT>
=  NOAUTH, sets the server to not require any authentication.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>AUTHTYPE
=  </B></I></SPAN></FONT></FONT></FONT>CLIENTCERT (default) requires
a certificate of all the clients. The certificates must be in the
signers access control list and be trusted by the Java distribution,
i.e imported in JAVA_HOME/jre/lib/security/cacerts. Authorized
clients is configured manually using the CLI interface.</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm; font-style: normal; font-weight: medium">
<BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">This
authorization functionality doesn't work for all use cases. Then it's
possible to create a customized authorizer and specify it's class
path as value in the AUTHTYPE property. The Processable will then
automatically instantiate and use it. </SPAN></SPAN>How to develop
such a plug-in is explained in the developers section. 
</P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
<BR>
</P>
<H2 LANG="en-GB" CLASS="western">9.2 MailSigner</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner support SMTP
Authentication which is configured in the build properties. It's then
possible to authorize users by adding them manually through the CLI
interface. SMTP authorization is global for all MailProcessors.</P>
<H1 LANG="en-GB" CLASS="western">10  Disabling a Signer</H1>
<P LANG="en-GB" CLASS="western">Any Processable worker in the
SignServer and MailSigner can be disabled, which means that it won't
be executed or be included in the health check. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">To disable a worker set the property
&ldquo;DISABLED&rdquo; to &ldquo;TRUE&rdquo;</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">11  Archiving Responses <I>(SignServer
only)</I></H1>
<P LANG="en-GB" CLASS="western">If there is a need to save all
generated responses, then set the property &ldquo;ARCHIVE&rdquo; to
&ldquo;TRUE&rdquo; and all generated responses for that signer will
be saved to database.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The archived responses can later be
extracted from data base using the CLI interface. See the CLI section
for more information.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">12  The Global Configuration Store</H1>
<P LANG="en-GB" CLASS="western">The available workers and its crypto
tokens and services is configured in something called the global
configuration store that is slightly different from a worker
configuration.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Is is dynamically configured and
activated immediately. I can contain any type of data (in string
representation) and can be of two types, either with global scope or
node scope. A Global scoped property can be accessed by  all nodes in
the cluster while a Node scoped property in only used within a node
and cannot be accessed by the other nodes.</P>
<H2 LANG="en-GB" CLASS="western">12.1 SignServer specific</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Database failure is handled
differently. If a node looses connection to the database it put
itself in a state called 'unsynchronised' and will continue its
operation without storing the data to database by using a cached
global configuration. It is possible to later resynchronise one nodes
cached global configuration data  with the database with a CLI
command called 'resync'. But it is only possible to sync one of the
nodes global configuration to the database.</P>
<H2 LANG="en-GB" CLASS="western">12.2 MailSigner Specific</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner doesn't store its data
in database but in a regular file handled internally. It have
therefore no functionality for database fail-over and cannot be
resynchronized. There currently aren't any difference in global and
node scoped variables.</P>
<H1 LANG="en-GB" CLASS="western">13  Timed Services</H1>
<P LANG="en-GB" CLASS="western">A Timed Service (formerly called just
service) is a task that is run on a timely basis, performing
maintenance tasks like changing active key, or it could generate a
report.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Currently isn't the SignServer
shipped with any services out of the box, but read the developer
section about how to write custom services.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">A Timed Service framework supports a
couple basic properties that is used to calculate when and how a
timed service should run. These properties are:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>ACTIVE</B></I></SPAN></FONT></FONT></FONT>
=  &ldquo;TRUE&rdquo; if the service should be run, otherwise it is
disabled.</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>SINGLETON</B></I></SPAN></FONT></FONT></FONT>
=  &ldquo;TRUE&rdquo; if the service only should be run on one of the
nodes in the cluster at the time. If it's not set or set to FALSE is
the service run simultaneously on all nodes in the cluster. If the
node running a singleton service fails will another node sense this
and start up the service</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>INTERVAL</B></I></SPAN></FONT></FONT></FONT>
=  <FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB">Property
that should define the interval i seconds the service should run.</SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><I><B>CRON</B></I></SPAN></FONT></FONT></FONT>=
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB">Property
that should define a CRON expression of how often the service should
run.  It should conform to Unix CRON standard. (One of INTERVAL or
CRON is required)</SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">14  The Main WebService Interface</H1>
<H2 LANG="en-GB" CLASS="western">14.1 Overview</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">New to version 3.0 is the Main
WebService interface. It replaces the RMI-SSL interface in version
1.0 and 2.0 for two reasons, the RMI-SSL were based on a commercial
library and it only worked for Java clients.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The WebService interface have two
calls, the main one is 'process' which takes a collection of process
request to a processable worker and returns a collection of process
responses, the second one is getStatus that performs a health check
of the node and returns an OK message if the node is healthy.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The WebService stack used is the
JAX-WS stack from SUN. And the actual process data is a externalized
Base64 byte-arrays. The reason why the are externalized is to simply
the integration towards non-Java platforms. See the source of the
actual request to see how the data is structured.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The getStatus call can be used to
implement high-availability towards the client. The Java client API
described in the next section have built in support for different
high availability policies.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The WebService WSDL file is located
at the URL
<A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="text-decoration: none">http://&lt;hostname&gt;:8080/signserver/</SPAN></FONT></FONT></FONT></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="text-decoration: none">signserverws/signserverws</SPAN></FONT></FONT></FONT></A><A HREF="http://localhost:8080/signserver/validationws/validationws?wsdl"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="text-decoration: none">?wsdl</SPAN></FONT></FONT></FONT></A></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It's possible to turn off the
WebService interface by disabling it in the build configuration.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Important</I>, Due to class path
conflict in JBoss 4.2.x own JBoss WebService stack and the JAX-WS
stack used by the SignServer must the JBoss WebService stack be
removed before the WebService is used. This is done by going to
JBOSS_HOME/server/default/deploy and remove the directory
jbossws.sar.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">14.2 Java Client API</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Built along with the WebService is a
Java API that can be used by clients. It's located in
dist-client/signserverwscli and the file signserverws.jar and all the
files in the lib directory is required to use the API. The client API
have support for different high availability policies to avoid the
need for load balance hardware.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The client classes is in the package
org.signserver.protocol.ws.client and the main code are
SignServerWSClientFactory creating a client using the specified load
balance policy, it returns a 
</P>
<P LANG="en-GB" CLASS="western">ISignServerWSClient that is used to
perform the actual process requests.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">14.2.1 Load Balance Policies</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
With version 3.0 is one load balance policy defined and it's called
<FONT COLOR="#000000">'</FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>CallFirstNodeWithStatusOK'
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB">it
calls the getStatus method on all the server nodes in the cluster
simultaneously and the first node to respond OK it sends its process
request to. This to ensure that only one node in the cluster actually
performs the signing.</SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB">Other
future load balance policies could be round robin or that all nodes
are called with the requests simultaneously and the first response is
used.</SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">14.2.2 CLI Client 
</H3>
<P LANG="en-GB" CLASS="western">Along with the Java Client API is
also a CLI utility provided, used mainly for testing but could in
some cases be used for scripting as well. Its located in the
dist-client/signserverwscli and all the files in the directory and
'lib' subdirectory is required. First edit the file
wsclient.properties, there it's possible to define connection
properties such as hosts, ports, SSL usage, load balance policy and
so on. It is also possible to define the classes used for request
generation, what type of request that should be generated and how the
response should be analysed. Default is just dummy requests sent to
the DummySigner used  to test WebService connectivity.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Below is the syntax of the CLI
command and can be used to perform continuous requests with a
specified rate with a multiple number of concurrent requesting
threads. This can be used to test performance of an implemented
worker and for stress testing.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>Usage:</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>wsclient
&lt;signer Id or Name&gt; &lt;number of requests&gt; &lt;milliseconds
between reques</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>t&gt;
&lt;number of threads&gt; &lt;random wait&gt;</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>Where:</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>Signer
id or name to send requests to, (required parameter)</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>Number
of requests is for each thread (default is '1'), use 'c' or 'continuo</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>us'
for infinite number of requests.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>Minimum
milliseconds between requests is the least time the client waits bef</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>ore
issuing the next (default is '1000').</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>Number
of threads that will send concurrent requests (default is '1').</FONT></FONT></P>
<P LANG="en-GB" CLASS="western">    <FONT FACE="Courier New, monospace"><FONT SIZE=2>Random
wait in milliseconds, used for more random test behaviour and is adde</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2>d
to the fixed wait time (default is '0').</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">  <FONT FACE="Courier New, monospace"><FONT SIZE=2>The
client requires a configuration file 'wsclient.properties' to exist
in the</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"> <FONT FACE="Courier New, monospace"><FONT SIZE=2>same
directory as the wscli, see the configuration file for more details.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">15  Building and Deploying the
SignServer or MailSigner</H1>
<P LANG="en-GB" CLASS="western">The building of the SignServer
framework is configured by copying the file
signserver_build.properties.sample to signserver_build.properties. In
this file it's possible to set which database that is going to be
used, how the web container should be configured and how many nodes
that is in the cluster. After it's configured issue the command 'ant'
followed by 'ant deploy' to send it to the application server.
Currently is JBoss the only supported application server and it
requires the environment variable JBOSS_HOME to be set prior to the
deploy command.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>How
to set-up a highly available SignServer cluster is described in a
separate document called</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>SignServer_3_0_Installation_Guide.pdf
that can be downloaded from </FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>http://www.signserver.org</FONT></FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
document describes how to set it up in a Cent OS 4.4 environment with
two service nodes and</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>one
management node, but should be rather easy to adjust to other
platforms.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Building
the MailSigner is very similar to the SignServer. Just set the
property 'build.mode' to 'MAILSIGNER' in the top of the build
configuration file and set the required settings (such as DNS
servers) in the bottom of the file. </FONT></FONT></FONT>Then build
the MailSigner with the command 'ant'. </FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>To
start up the MailSigner application issue the command 'ant run'. If
you want to debug the application in a IDE such as Eclipse issue the
command  'ant debug'. This can be very helpful when developing
MailProcessors. In Eclipse create a 'Remote Java Application' debug
configuration and have it to connect to port 8000, then set a break
point in your code and it will stop there the next time the
MailSigner enters that state.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Since
the MailSigner is built upon the JAMES SMTP server it is possible to
configure the SMTP server more than is available in the build
configuration file. This is done in the file
extapps/james/apps/james/SAR-INF/config.xml, see the JAMES
documentation for more information about what is possible and how to
do it.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">16  Administrating the SignServer</H1>
<P LANG="en-GB" CLASS="western">The SignServer and the MailSigner is
administrated using a common CLI interface located in
bin/signserver.sh/cmd. Most of the commands work in the same way for
both build.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Every worker is identified by a id
and optionally a name that can be used in all the CLI commands.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It is possible to do configuration of
a worker while it's in production. All configuration commands are
cached until a reload command is issued and the configuration becomes
active.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">There is a special property file for
the cli interface called signserver_cli.properties defining which
nodes that exists in the cluster. The properties are:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>hostname.masternode</B></I>
= Should only contain one of the nodes, specified as the default
master node. Used by operations dealing with the database and where
not all nodes in the cluster needs to be contacted. It is possible to
override this setting in the CLI by using the -host &lt;host name&gt;
parameter.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><SPAN STYLE="text-decoration: none"><B>hostname.allnodes</B></SPAN></I>
= Should contain all the nodes in the cluster, separated by a ';'.
Mainly used by the commands getStatus, activateCryptoToken and
deactivateCryptoToken.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Its possible to customize the CLI
with your own code. How to do this is described in the development
section.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">16.1 General Commands</SPAN></H2>
<P LANG="en-GB" CLASS="western">These commands applies for all types
of workers and works in the same way for both the SignServer and
MailSigner.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Get Status Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Returns the status of the given
worker, it says if its crypto token is active or not and the loaded
'active' configuration. It is possible to get a brief summary or a
complete listing for one worker or all configured workers. If all
workers are displayed will also all the global configuration
parameters be displayed.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Get Configuration Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Returns the current worker or global
configuration depending on options.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">For worker configuration observe that
this configuration might not have been activated yet, not until a
'reload' command is issued.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Set Property Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Sets a custom property used by the
worker or crypto token, see reference for the given Worker and
CryptoToken for available properties.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Set Properties Command</B></I></P>
<P LANG="en-GB" CLASS="western">Command used to batch a set of
properties, both for the global and worker configuration.</P>
<P LANG="en-GB" CLASS="western">It can be used to configure a Signer
in a test environment, dump all the properties and upload it into
production.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>It reads all the
configuration properties form a property file and depending on the
contents of the key it sets the given property. All properties will
be set  according to the following defined rule set.</P>
<TABLE WIDTH=100% BORDER=1 BORDERCOLOR="#000000" CELLPADDING=4 CELLSPACING=0>
	<COL WIDTH=128*>
	<COL WIDTH=128*>
	<THEAD>
		<TR VALIGN=TOP>
			<TH WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Rule</P>
			</TH>
			<TH WIDTH=50%>
				<P LANG="en-GB" CLASS="western">Comment</P>
			</TH>
		</TR>
	</THEAD>
	<TBODY>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Properties starting
				with id&lt;num&gt;.</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Will set the property
				to the value of the given id to the worker with the given id.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Properties starting
				with name&lt;name&gt;.</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Will set the property
				to a worker with the given name. (If the name doesn't exists a
				unique id will be generated and assigned).</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Property keys
				containing GENID&lt;NUM&gt;, example WORKERGENID1 or GLOB.
				WORKERGENID1 
				</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>The SignServer will
				find a free unique id and assign substitute all GENID&lt;num&gt;
				with this id.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Properties starting
				with glob.</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Will set a global
				property with global scope.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Properties starting
				with node.</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Will set a global
				property with node scope.</P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Properties starting
				with -&lt;other prefix&gt;&lt;value&gt;</P>
			</TD>
			<TD WIDTH=50%>
				<P LANG="en-GB" CLASS="western" ALIGN=LEFT>Will remove the
				property, either worker or global.</P>
			</TD>
		</TR>
	</TBODY>
</TABLE>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>See the directory
'sample-configs' for examples.</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Remove Property Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Removes a configured property</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Dump Properties</B></I></P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
This tool will dump all configured properties for one or all workers
in the system into a property file. If the configuration for one
worker is dumped it can be used to transfer the configuration from
one installation to another. If all configurations is dumped, it can
be used as a backup tool.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Upload Certificate Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Used to upload the certificate when
the worker only needs the actual signing certificate and not the
entire chain.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Upload Certificate Chain
Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Used when uploading a complete
certificate chain to the worker. Which command that is supposed to be
used is depending on the worker and crypto token used.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><I><B>Generate
Certificate Request Command</B></I></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Used
to generate a certificate request for a worker to be signed by a
certificate authority. It takes</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>distinguished
name and signature algorithm as parameters and writes the request in
PEM format to</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>file.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Activate Cryptographic Token
Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Used to activate hard crypto tokens.
Authentication code is usually the PIN used to unlock the keys  on
the HSM. Not used if the token is set to auto-activation.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Deactivate Cryptographic Token
Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Brings a crypto token off-line. Not
used if token is set to auto-activation.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">16.2 SignServer Specific Commands</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">16.2.1 Authorization Related</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">These commands are used to configure
the internal client certificate authorization when it is turned on.
It controls which clients that is authorized to request a processable
worker.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Add Authorized Client Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Adds a client certificate to a
processable workers list of acceptable clients using this worker.
Specify</P>
<P LANG="en-GB" CLASS="western">certificate serial number in hex and
the Issuer DN of the client certificate.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Removes Authorized Certificate
Command</B></I>:</P>
<P LANG="en-GB" CLASS="western">Removes added client certificate
entries.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>List Authorized Clients
Commands</B></I>:</P>
<P LANG="en-GB" CLASS="western">Displays the current list of
acceptable clients.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">16.2.2 Database Related</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Resynchronize Database Command:</B></I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The 'resync' command is used after a
SignServer had a complete database failure. When this happens  will
the Global Configuration become in 'Off-line' mode and it's not
possible for the nodes to communicate internally and the Global
Configurations will not be in sync any more. After the database is up
again can this command be sent to the node that have the most valid
Global Configuration and write it to the database. After this will
the Global Configuration be in 'On-line' mode again.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">16.2.3 Archive Related</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">This commands can be used for
processable workers that have archiving turned on. They are used to
find specific archived responses. It's up to the implementation of
the worker if it supports archiving or not.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Archive Find from Archive Id
Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Command used to extract archived data
from database identified by the archive Id.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The Id depends on the worker, in case
of the TSA is the TimeStampInfo serial number used.</P>
<P LANG="en-GB" CLASS="western">The data is stored with the same file
name as the archive id in the specified path.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Archive Find from Request IP
Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Used to extract all archived data
requested from a specified IP address.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">All data is stored as separate files
with the archive id as file name in the specified path.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Archive Find from Request
Certificate Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Used to extract all archived data
requested from a client by specified it's certificates serial number
and  issuer DN.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">All data is stored as separate files
with the archive id as file name in the specified path.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">16.2.4 Group Key Service Related</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">These commands only applies for group
key services.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Pregenerate Group Keys Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Command used to pregenerate a given
number of group keys for a given group key service and stores them
unassigned encrypted in the database. This commands can be used to
let the cluster work on CPU insensitive key generation during low
business hours.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Remove Group Keys Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Command used to remove group keys not
used any more. A time range of when created, first used and last
fetched can be used as criteria.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Switch Encryption Key Commands:</B></I></P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
Command used manually switch the encryption key used to secure the
group keys in database. Usually is the encryption key switched
automatically but this command can be used to override this default
behaviour.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">16.3 MailSigner Specific Commands</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Add Authorized User Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Command to add a SMTP authorized user
to a MailSigner, it applies for all configured MailProcessors.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Remove Authorized User Command:</B></I></P>
<P LANG="en-GB" CLASS="western">Removes an authorized SMTP user.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>List Authorized Users Command:</B></I></P>
<P LANG="en-GB" CLASS="western" STYLE="font-style: normal; font-weight: medium">
List currently authorized STMP users.</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">17  Making the SignServer
highly-available</H1>
<P LANG="en-GB" CLASS="western">Here are some tips on configuration
used to make the SignServer redundant. Usually is the SignServer
set-up with three nodes (required minimum for MySQL cluster) where
one node is a management node from were all deployment and
administration is done and the other two services are service nodes
processing the actual requests.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">17.1 HTTP access requires a load
balancer</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">HTTP based workers like the TSA can
be clustered using a load balancer accessing a health check servlet
returning the state of the SignServer. The basic settings of the
health check servlet can be configured in the build configuration
file but more advanced settings are done in
'src/web/healthcheck/WEB-INF/web.xml'. With the default settings will
the servlet return the text 'ALLOK' when accessing the URL
<A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth">http://localhost:8080/signserver/</A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><FONT FACE="Courier New"><FONT SIZE=2><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth">healthcheck/signserverhealth</A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A><A HREF="http://localhost:8080/signserver/healthcheck/signserverhealth"></A>.
</FONT></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=3>If
something is wrong with the sign server will an error message be sent
back instead.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT FACE="Times New Roman, serif"><FONT SIZE=3>The
health check servlet can also be used to monitor the SignServer by
creating a script that monitors the URL periodically for error
messages.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Tip, heartbeat with ldirectord is a
good solution for a load balancer and works well with the SignServer.
KeepAlived is another open source solution.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The Main WebService using the Java
client API manages the HA parts itself and then isn't a load balancer
necessary.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">17.2 Setting up a MySQL Cluster</SPAN></H2>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
database backed of the SignServer can be made redundant using MySQL
Cluster. Details on how to set-up the MySQL cluster can be found in
the document SignServer_3_Installation_Guide.pdf that can be
downloaded from </FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>http://www.signserver.org.</FONT></FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>More
information about the MySQL Cluster can be found at</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#0000ff"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>http://www.mysql.com/products/database/cluster/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">17.3 MailSigner</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The MailSigner have no built in
support for high-availability instead are the standard SMTP approach
used where multiple server can be set up with different priority in
the DNS MX records. 
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">18  For Developers</H1>
<P LANG="en-GB" CLASS="western">This section describes the details of
how to develop your own plug-ins for the SignServer API. It goes
through most of the necessary interfaces to get going.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">18.1 Building with Customized Code</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It is possible to have your own code
in a separate code tree to avoid a mix of custom code with SignServer
project code. This makes it easier to maintain and update the code
for future versions. This is done by configuring one or more of the
'custom.' parameters in the build configuration file. The are each
described here:</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>custom.src.java
= </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Should
point to an external directory containing the package base of the
Java code. These are then included in the compilation at build time.<BR></SPAN></SPAN><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>custom.src.web
= </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Should
point to the base of a WAR source tree with WEB-INF/web.xml included.
This will replace the default WAR deployed during the build.</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><I><B>custom.build.xml
= </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">This
can point to a custom build.xml that will be imported from the main
build.xml and lets the developer include his own ant tasks if
necessary.</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western" STYLE="margin-left: 1.27cm"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.27cm; background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><SPAN LANG="en-GB"><I><B>custom.commandfactory
= </B></I></SPAN></FONT><FONT COLOR="#000000"><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Should
point to a custom implementation of the interface
org.signserver.cli.</SPAN></SPAN></SPAN></FONT><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">ISignServerCommandFactory</SPAN></SPAN></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><I><B>.
</B></I></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">This
gives to ability to extend (or replace) the default CLI with another
one. The best way of extending the CLI is to look at  how the
</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">DefaultSignServerCommandFactory</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">
 is structured.</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">18.2 Implementing Workers</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The main component in the SignServer
is the Worker from which most other components inherits. To get a
better overview of how the different component types relate to one
and another see illustration 1 in the Overview section.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Most workers work in the same way but
with different interfaces to implement but for all of them should the
following steps be performed.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Create
	a custom  class implementing the specified interface. There usually
	exists a base class implementing the most basic function to simply
	the implementation even further. If it exists it's recommended to
	inherit it.</FONT></FONT></P>
</UL>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>You
	can define your own properties that the worker can use for its
	configuration.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Make
	sure the custom class is available to the application server</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Redeploy
	the SignServer.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Register
	the worker in the application by setting a property
	</FONT></FONT><FONT FACE="CourierNewPSMT">WORKER&lt;id&gt;.CLASSPATH
	</FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>with a global
	scope in the global configuration. (Also make sure to set it's
	crypto tokens class-path, see separate section).</FONT></FONT></FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Reload
	the service with the CLI reload command.</FONT></FONT></FONT></P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.2.1 The ISigner Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>A Signer is a component
used to perform some form of cryptographic processing of requested
data and to c<FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>reate
a custom signer class it should  implement the
org.signserver.server.signers.ISigner interface. There exists a
BaseSigner that can be inherited taking care of some of the
functionality. If the BaseSigner is inherited the only method that
needs to be implemented is '</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2>processData</FONT></FONT></FONT><FONT COLOR="#000000"><FONT SIZE=3><FONT FACE="TimesNewRomanPSMT">()
'.</FONT></FONT></FONT></P>
<UL>
	<P LANG="en-GB" CLASS="western" ALIGN=LEFT></P>
</UL>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>There exists a DummySigner
implementation that is used for demonstration purposes.</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.2.2 The ITimedService Interface</H3>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>There
are two kinds of timed services, singleton or non-singleton. A
singleton service is only run at one of the nodes at the time while
non-singleton services are run at all nodes simultaneously. If a
singleton </FONT></FONT></FONT>service fails to run on one of the
nodes will one of the other nodes take over the service</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>automatically.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>If
a service should be singleton or not is determined by a standard
property </FONT></FONT><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="text-decoration: none"><SPAN STYLE="font-weight: medium">SINGLETON</SPAN></SPAN></SPAN></FONT></FONT><FONT FACE="TimesNewRomanPS-BoldItalicMT"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="text-decoration: none"><SPAN STYLE="font-weight: medium">
</SPAN></SPAN></SPAN></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>defined</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>in
the ServiceConfig class.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Other
basic properties used to configure all services are:</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="Courier New, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">ACTIVE
</SPAN></SPAN></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>when
set to </FONT></FONT><FONT FACE="CourierNewPSMT">&ldquo;TRUE&rdquo;
</FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>means that the
service is active and should be run.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">INTERVAL
</SPAN></SPAN></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>defining
the interval in seconds of how often the service should be run.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
<FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">CRON</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>
used as a complement to </FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">INTERVAL</SPAN></SPAN></SPAN></FONT></FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>
to specify on a calendar basis.</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<UL>
	<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>To
	create </FONT></FONT></FONT>a custom timed service class it should
	implement the org.signserver.server.timedservices.ITimedService
	interface. There exists a BaseTimedService that can be inherited
	taking care of most of the basic functionality. If the
	BaseTimedService is inherited the the only method that needs to be
	implemented is the 'work()' method.<FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3><BR></FONT></FONT></FONT></FONT></FONT><BR>
	</P>
</UL>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The work method that
needs to be implemented is described here:</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">do</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">actual</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">work</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">and</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implemented</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">by</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">all</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">services.</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">The</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">run</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">at</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">periodical</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">interval</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">defined</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">getNextInterval.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ServiceExecutionFailedException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">execution</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failed</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">	</FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>public</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
</FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>void</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
work() </FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>throws</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
ServiceExecutionFailedException;</FONT></FONT></FONT></P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>There
exists a DummyTimedService implementation that is used for
demonstration purposes.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="page-break-before: always">
<BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.2.3<FONT COLOR="#000000"><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>
</FONT></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=4><SPAN LANG="en-GB"><I><SPAN STYLE="font-weight: medium">IValidationService
Interface</SPAN></I></SPAN></FONT></FONT></FONT></H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><FONT COLOR="#000000"><FONT FACE="Times New Roman, serif"><FONT SIZE=3><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">Just
as the other worker plug-ins have the validator service a base class
taking care of most of the common methods and the only method that
needs to be implemented is the 'validate' method below. But for most
applications should the DefaultValidationService work. What is
probably more interesting is to develop a custom IValidator used to
integrate the default validation service against different
certificate status repositories. See section called 'Other
Customizations' for details of how to implement a Validator.</SPAN></SPAN></SPAN></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><I><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></I></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validationRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ValidateResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">didn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">conform</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">with</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
  </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">specification.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validation</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.validationservice.common.ValidateRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.validationservice.common.ValidateResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	ValidateResponse
validate(ValidateRequest validationRequest) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.2.4 IGroupKeyService Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">To customize a group key service is
slightly more work. Then need five methods be implemented:
'fetchGroupKey', 'pregenerateGroupKeys', 'swithEncryptionKey',
'removeGroupKeys' and 'getStatus'. The default implementation stores
the group keys in database with a reference to the encryption key
used, the encryption key is stored in the extended key store. See the
JavaDoc and the code for the default group key service for more
details of implementing a customized one.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Main</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Group</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">responsible</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">fetching</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">from</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">database.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">fetchKeyRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">FetchKeyReponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">didn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">conform</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">with</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specification.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.FetchKeyRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.FetchKeyResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	FetchKeyResponse
fetchGroupKey(FetchKeyRequest fetchKeyRequest) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instructs</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">group</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">pregenerate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keys.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">called</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">at</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">periods</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">when</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">server</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">having</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">low</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">load.</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">option</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">optional</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implement,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">doesn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">support</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">this</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">null.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">pregenerateKeysRequest</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">response</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">containing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">number</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generated,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">etc</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">requests</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">contain</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unsupported</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.PregenerateKeysRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.PregenerateKeysResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	PregenerateKeysResponse
pregenerateGroupKeys(PregenerateKeysRequest pregenerateKeysRequest)
</FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instructing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">switch</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encryption</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">for</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">storing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">group</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">database.</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ensure</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">one</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encryption</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exposed</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">through</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">much</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">optional</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implement,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implemented</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">null.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">switchEncKeyRequest</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">response</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">containing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">result</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">operation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">such</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">as</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">new</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">index.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">requests</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">contain</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unsupported</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
 </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.SwitchEncKeyRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.SwitchEncKeyResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	SwitchEncKeyResponse
switchEncryptionKey(SwitchEncKeyRequest switchEncKeyRequest) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instructing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">remove</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">old</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">group</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">anymore</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">caller</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">supports</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">type</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IRemoveGroupKeyRequest</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used.</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">The</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">contain</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specifying</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">which</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">removed.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">optional</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implement,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implemented</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">null.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">removeGroupKeyRequests</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">response</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">containing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">result</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">operation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">such</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">as</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">number</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keys</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">actually</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">removed.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">requests</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">contain</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unsupported</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
 </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.RemoveGroupKeyResponse</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@see</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">org.signserver.groupkeyservice.common.IRemoveGroupKeyRequest</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	RemoveGroupKeyResponse
removeGroupKeys(IRemoveGroupKeyRequest removeGroupKeyRequests) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">actual</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">worker,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">could</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">signer</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">activated</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">not,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">equivalent</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">service.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">WorkerStatus</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">	</FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>public</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
WorkerStatus getStatus();</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.2.5 IMailProcessor Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">Implementing a MailProcessor for the
MailSigner is almost exactly the same as for the other components but
here it's the 'service' method that needs to be implemented. There
also exists a utility class called SMIMEHelper that contains methods
for securing emails.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Main</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">when</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">processing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">mails</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">mail</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">mail</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">sent</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">through</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SMTP</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">server</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">MessagingException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">error</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">occurred</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">processing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">mail.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">signing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">available</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">at</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">time</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">process.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">	</FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>void</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
service(Mail mail) </FONT></FONT><FONT COLOR="#7f0055"><FONT FACE="Courier New, monospace"><B>throws</B></FONT></FONT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">
MessagingException, CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<H2 LANG="en-GB" CLASS="western">18.3 Implementing Crypto Tokens</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.3.1 The ICryptoToken Interface</H3>
<UL>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>A
	custom crypto token needs to implement the interface
	org.signserver.server.cryptotokens.ICryptoToken.  See P12CryptoToken
	for an example implementation.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>You
	can define own properties for a crypto token in the same way as for
	workers. The properties are sent to the crypto token upon
	initialization.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Make
	sure the custom class is available to the application server</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Redeploy
	the SignServer.</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Register
	the crypto token to a worker in the application by setting a
	property <FONT FACE="CourierNewPSMT"><FONT SIZE=2>WORKER&lt;id&gt;.CRYPTOTOKEN.CLASSPATH
	</FONT></FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>with a
	global scope in the global configuration. (Also </FONT></FONT>make
	sure to set it's crypto tokens class-path, see next section).</FONT></FONT></P>
	<LI><P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Reload
	the service with the CLI reload command.</FONT></FONT></P>
</UL>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="background: transparent; widows: 2; orphans: 2">
<FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The ICryptoToken
interface have the following methods that needs to be implemented:</FONT></FONT></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western"><FONT FACE="Courier New, monospace"><FONT SIZE=2><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>interface</B></FONT><FONT COLOR="#000000">
ICryptoToken {</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>static</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>final</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#0000c0"><I>PURPOSE_SIGN</I></FONT><FONT COLOR="#000000">
= 1;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>static</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>final</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#0000c0"><I>PURPOSE_DECRYPT</I></FONT><FONT COLOR="#000000">
= 2;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>static</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>final</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#0000c0"><I>PROVIDERUSAGE_SIGN</I></FONT><FONT COLOR="#000000">
   = 1;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>static</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>final</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#0000c0"><I>PROVIDERUSAGE_DECRYPT</I></FONT><FONT COLOR="#000000">
= 2;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">  
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">called</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">after</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">creation</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instance.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT><FONT COLOR="#000000">	</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
init(Properties props) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenInitializationFailureException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">  </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">returns</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">current</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">  </FONT><FONT COLOR="#3f5fbf">Should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">one</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignerStatus.STATUS_..</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">values</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
getCryptoTokenStatus();</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">activate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignTokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">when</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connected</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">after</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">being</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">off</FONT><FONT COLOR="#7f7f9f">-</FONT><FONT COLOR="#3f5fbf">line.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authenticationcode</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unlock</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token,</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">i.e</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PIN</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">smartcard</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">HSMs</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignToken</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">available</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connected.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenAuthenticationFailureException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">with</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">error</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">message</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authentication</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">fail.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
activate(String authenticationcode) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenAuthenticationFailureException,
CryptoTokenOfflineException;    </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">deactivate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">set</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">too</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">off</FONT><FONT COLOR="#7f7f9f">-</FONT><FONT COLOR="#3f5fbf">line</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">and</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">reset</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">HSMs</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authorization</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">code.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">true</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">deactivation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">was</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">successful.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>boolean</B></FONT><FONT COLOR="#000000">
deactivate();    </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Returns</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">private</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">(if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">possible)</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">purpose</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">one</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PURPOSE_...</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">constants</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoToken</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">available</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connected.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PrivateKey</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
PrivateKey getPrivateKey(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
purpose) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Returns</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">public</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">(if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">possible)</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">purpose</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">one</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PURPOSE_...</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">constants</FONT><FONT COLOR="#000000">  
 </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoToken</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">not</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">available</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connected.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PublicKey</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
PublicKey getPublicKey(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
purpose) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Returns</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">signature</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Provider</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">sign</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">things</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">with</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
 </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">PrivateKey</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">returned</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">by</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">this</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">device</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
 </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">providerUsage</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">one</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ICryptoToken.PROVIDERUSAGE_</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">constants</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
 </FONT><FONT COLOR="#3f5fbf">specifying</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">usage</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">private</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">String</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">name</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Provider</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
String getProvider(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
providerUsage);</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">returning</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">included</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">only</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implemented</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">by</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">soft</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">which</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">have</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">included</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">store.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">All</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">other</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">'null'</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">and</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">let</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">signer</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">fetch</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">from</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">database.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
Certificate getCertificate(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
purpose) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">returning</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">chain</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">included</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">This</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">only</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implemented</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">by</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">soft</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">which</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">have</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificates</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">included</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">store.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">All</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">other</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tokens</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">'null'</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">and</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">let</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">signer</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">fetch</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">from</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">database.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">   
</FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>abstract</B></FONT><FONT COLOR="#000000">
Collection&lt;Certificate&gt; getCertificateChain(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
purpose) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT>    
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">tell</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">create</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">using</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">its</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
ICertReqData genCertificateRequest(ISignerCertReqInfo info) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">remove</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">signer</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">shouldn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">any</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">more</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">purpose</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">on</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ICryptoToken.PURPOSE_</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">constants</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">true</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">removal</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">was</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">successful.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>boolean</B></FONT><FONT COLOR="#000000">
destroyKey(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
purpose);</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}</FONT></FONT></P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.3.2 The Extended Crypto Token
Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The default group key service need
support for symmetric keys in addition the the functionality provided
in the basic crypto token which mainly focuses on asymmetric key
functionality.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The extended crypto token adds four
more methods that need implementation used to generate exportable
keys (symmetric or asymmetric) and to encrypt/decrypt data using
symmetric keys.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>interface</B></FONT><FONT COLOR="#000000">
IExtendedCryptoToken </FONT><FONT COLOR="#7f0055"><B>extends</B></FONT><FONT COLOR="#000000">
ICryptoToken {</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instructing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generate</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">returned</FONT><FONT COLOR="#000000">
</FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keyAlg</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">algorithm</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generate,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">caller</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">supports</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">value.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keySpec</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specification</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key,</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">caller</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">supports</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">value.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">either</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">java.security.Key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">java.security.KeyPair</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">depending</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">on</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">type</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">keyAlg</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">sent</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">doesn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">support</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">alg</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">spec.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	Serializable
genExportableKey(String keyAlg, String keySpec) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Instructs</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generate</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">stored</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">device</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">returning</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">only</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">alias</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">reference</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keyAlg</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">algorithm</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">generate,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">caller</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keySpec</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keySpec</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specification</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key,</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it's</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">caller</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">supports</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">value.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">reference</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">can</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">later</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encryption/decryption.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">doesn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">support</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">alg</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">spec.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	String
genNonExportableKey(String keyAlg, String keySpec) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException,  CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encrypt</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">using</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">stored</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token.</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">This</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">mainly</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">symmetric</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encryption.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keyRef</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">alias</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">reference</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encrypt.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encrypted</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>byte</B></FONT><FONT COLOR="#000000">[]
encryptData(String keyRef, </FONT><FONT COLOR="#7f0055"><B>byte</B></FONT><FONT COLOR="#000000">[]
data) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException; </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">decrypt</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">using</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">stored</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token.</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">This</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">mainly</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">symmetric</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encryption.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">keyRef</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">alias</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">reference</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">key</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">that</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">used.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">decrypt.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">encrypted</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>byte</B></FONT><FONT COLOR="#000000">[]
decryptData(String keyRef, </FONT><FONT COLOR="#7f0055"><B>byte</B></FONT><FONT COLOR="#000000">[]
data) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
CryptoTokenOfflineException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000"><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}</FONT></FONT></FONT></P>
<HR>
<H2 LANG="en-GB" CLASS="western">18.4 Other Customizations</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.4.1 The IValidator Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">A Validator is used in the
DefaultValidationService to connect to different kinds of certificate
status repositories, such as CRL, OCSP, XKMS, database etc. It
contains two methods 'validate' used for the actual certificate
validation and 'testConnection' used by health check related
functionality to check that the connection to the underlying
validator resource is alright.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Main</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Validation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Service</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">responsible</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validating</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificates.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Important</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">validator</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">also</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">have</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">support</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">check</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">revocation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#000000">    
    </FONT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">involved</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">CA</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificates</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">and</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">should</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">only</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Validation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">with</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">status</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">REVOKED</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">VALID</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">If</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validator</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">doesn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">support</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">given</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">issuer</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">it</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">must</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">return</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">null.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">cert</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validate.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@return</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">Validation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">object</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">null</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">couldn't</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">looked</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">up</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">this</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validator.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">didn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">conform</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">with</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specification.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">CryptoTokenOfflineException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">crypto</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">token</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">online.</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	Validation
validate(ICertificate cert) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, CryptoTokenOfflineException,
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Optional</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">used</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">test</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connection</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">a</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">specific</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">underlying</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validator</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">ConnectException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">connection</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">underlying</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validator</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">implementation</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failed.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">general</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">failure</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">exception</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">validation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
testConnection() </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
ConnectException, SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">	</FONT></FONT></FONT></P>
<HR>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">18.4.2 The IAuthorizer Interface</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It's possible to integrate the
authorization of processable requests with external authorizations
applications. All that is needed is a class implementing the
IAuthorizer interface containing two methods, 'init' and
'isAuthorized'.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">To register that the customized
authorizer should be used by a worker, all that's needed to be done
is to set the property AUTHTYPE to the class path of the authorizer
implementation.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<HR>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><B>public</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#7f0055"><B>interface</B></FONT><FONT COLOR="#000000">
IAuthorizer {</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">called</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">by</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">worker</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">upon</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">first</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">call</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authenticator</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">after</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">instantiation.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">workerId</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">id</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">worker.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">config</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">active</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">worker</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">configuration</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">worker</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">em</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServer</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">EntityManager</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unexpected</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">error</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">occurred</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">initialization.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
init(</FONT><FONT COLOR="#7f0055"><B>int</B></FONT><FONT COLOR="#000000">
workerId, WorkerConfig config, EntityManager em) </FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#3f5fbf">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">Main</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">method</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">determining</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">requester</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">is</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authorized</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">process</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">in</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT></FONT></FONT>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">request</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">sent</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">worker</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">to</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">process.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@param</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">requestContext</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">containing</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">optional</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">clientCert</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">client</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">certificate</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">remote</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IP</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">of</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">user,</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">may</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">also</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">contain</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">customly</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">defined</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">data.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">SignServerException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">unexpected</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">error</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">occurred</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">during</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authorization.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#7f9fbf"><B>@throws</B></FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">IllegalRequestException</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">if</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">the</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">requester</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">isn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authorized</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">or</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">couldn't</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">be</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">authenticated</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">for</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#3f5fbf">some</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">other</FONT><FONT COLOR="#000000">
</FONT><FONT COLOR="#3f5fbf">reason.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	
</FONT><FONT COLOR="#3f5fbf">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Courier New, monospace"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000">	</FONT><FONT COLOR="#7f0055"><B>void</B></FONT><FONT COLOR="#000000">
isAuthorized(ProcessRequest request, RequestContext requestContext)
</FONT><FONT COLOR="#7f0055"><B>throws</B></FONT><FONT COLOR="#000000">
IllegalRequestException, SignServerException;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#000000"><FONT FACE="Courier New, monospace">}</FONT></FONT></FONT></P>
<HR>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">18.5 Using the Global Configuration
Store</SPAN></H2>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
global configuration store is a memory bank that workers can use to
store data used</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>in
ongoing operations. The data can be either node (i.e. only read by
the current node) or global</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>scoped.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>To
access the global configuration store use the
</FONT></FONT><FONT FACE="CourierNewPSMT">getGlobalConfigurationSession()
</FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>method</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>from
the BaseWorker (inherited by most of the base component
implementations). The returned</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>GlobalConfigurationSession
have the following methods that can be used (the other ones should be</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>avoided)</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*
Method setting a global configuration property. For node. prefix will
the</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">node
id be appended.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@param
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">scope,
one of the GlobalConfiguration.SCOPE_ constants</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@param
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">key
of the property should not have any scope prefix, never null</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@param
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">value
the value, never null.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><FONT FACE="CourierNewPS-BoldMT"><B>public
void </B></FONT></FONT><FONT FACE="CourierNewPSMT">setProperty(
java.lang.String scope,java.lang.String</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">key,java.lang.String
value ) ;</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*
Method used to remove a property from the global configuration.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@param
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">scope,
one of the GlobalConfiguration.SCOPE_ constants</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@param
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">key
of the property should start with either glob. or node., never</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">null</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@return
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">true
if removal was successful, othervise false.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><FONT FACE="CourierNewPS-BoldMT"><B>public
boolean </B></FONT></FONT><FONT FACE="CourierNewPSMT">removeProperty(
java.lang.String scope,java.lang.String key )</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">;</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">/**</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*
Method that returns all the global properties with Global Scope and
Node</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">scopes
properties for this node.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">*
</FONT></FONT><FONT COLOR="#7fa0c0"><FONT FACE="CourierNewPS-BoldMT"><B>@return
</B></FONT></FONT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT">A
GlobalConfiguration Object, nevel null</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT COLOR="#3f5fc0"><FONT FACE="CourierNewPSMT"><FONT SIZE=1 STYLE="font-size: 8pt">*/</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=1 STYLE="font-size: 8pt"><FONT COLOR="#7f0055"><FONT FACE="CourierNewPS-BoldMT"><B>public
</B></FONT></FONT><FONT FACE="CourierNewPSMT">org.signserver.common.GlobalConfiguration
getGlobalConfiguration( ) ;</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: none; border-right: none; padding-top: 0cm; padding-bottom: 0.07cm; padding-left: 0cm; padding-right: 0cm">
<BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
getGlobalConfiguration returns a GlobalConfiguration and have a
method</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="CourierNewPSMT">String
getProperty(String scope, String property) </FONT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>that
can be used.</FONT></FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>The
value of the property can be user-defined as long as it is guaranteed
to be unique over the entire</FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>application.<BR></FONT></FONT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><FONT FACE="Verdana"><FONT SIZE=2><FONT FACE="TimesNewRomanPSMT"><FONT SIZE=3>Reserved
values are all property keys starting with &ldquo;</FONT></FONT><FONT FACE="CourierNewPSMT">WORKER&rdquo;.</FONT></FONT></FONT></P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT><BR>
</P>
<P LANG="en-GB" CLASS="western" ALIGN=LEFT STYLE="page-break-before: always">
<BR>
</P>
<H1 LANG="en-GB" CLASS="western">19  Testing</H1>
<P LANG="en-GB" CLASS="western">There exists some test scripts used
to test that the SignServer functions correctly. They are described
here. 
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H2 LANG="en-GB" CLASS="western">19.1 Automatic Junit Tests</SPAN></H2>
<P LANG="en-GB" CLASS="western">Automatic Junit tests lies in the
directory '<FONT FACE="Courier New, monospace"><FONT SIZE=2>src/tests</FONT></FONT>'.
There are two different test suites, one for the SignServer build and
the other for the MailSigner. The same command applies for both.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I><B>Important: </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: medium">For
the SignServer test suite to run successful through all the tests
must both the Main WebService and validation service WebService API
be enabled in the build configuration.</SPAN></SPAN></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">To run the test suite do the
following:</P>
<UL>
	<LI><P LANG="en-GB" CLASS="western">Set the environment variable
	SIGNSERVER_HOME</P>
	<LI><P LANG="en-GB" CLASS="western">Make sure the sign server is
	deployed and JBoss is running</P>
	<LI><P LANG="en-GB" CLASS="western">do 'ant test:run' 
	</P>
	<LI><P LANG="en-GB" CLASS="western">A protocol is generated in the
	directory 'tmp/bin/junit'<BR><BR>
	</P>
</UL>
<H2 LANG="en-GB" CLASS="western">19.2Testing the TimeStamp Authority</SPAN></H2>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">19.2.1 The TSA Test Client</H3>
<P LANG="en-GB" CLASS="western">There exists a Time Stamp Authority
test client that is built with the main distribution. For other
workers it's recommended to test it with the WS CLI client described
in the 'Main WebService' section.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It only works without client
authentication requirements and through HTTP.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">To run the client do</P>
<P LANG="en-GB" CLASS="western"><SAMP><FONT SIZE=2>ant</FONT></SAMP></P>
<P LANG="en-GB" CLASS="western"><SAMP><FONT SIZE=2>cd dist-client</FONT></SAMP></P>
<P LANG="en-GB" CLASS="western"><SAMP><FONT SIZE=2>java -jar
timeStampClient.jar
&ldquo;http://&lt;hostname&gt;:8080/signserver/tsa?signerId=1&rdquo;</FONT></SAMP></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">It will continuously make one request
per second.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<H3 LANG="en-GB" CLASS="western">19.2.2 Manual Tests</H3>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western">The time stamp signer have been
tested with the OpenTSA client with both HTTP and HTTPS.</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western" STYLE="page-break-before: always"><BR>
</P>
<H1 LANG="en-GB" CLASS="western">20  References</H1>
<P LANG="en-GB" CLASS="western"><I>Java  (<A HREF="http://java.sun.com/">http://java.sun.com</A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Jboss  (<A HREF="http://www.jboss.org/">http://www.jboss.org</A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Apache James mail server 
(<A HREF="http://james.apache.org/">http://james.apache.org/</A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Apache Ant (<A HREF="http://ant.apache.org/">http://ant.apache.org</A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>Bouncycastle
(<A HREF="http://www.bouncycastle.org/">http://www.bouncycastle.org</A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
<P LANG="en-GB" CLASS="western"><I>RFC3161, Time-Stamp Protocol (TSP)
(<A HREF="http://www.ietf.org/"></A><A HREF="http://www.ietf.org/"></A><A HREF="http://www.ietf.org/">http://www.ietf.org</A><A HREF="http://www.ietf.org/"></A><A HREF="http://www.ietf.org/"></A>)</I></P>
<P LANG="en-GB" CLASS="western"><BR>
</P>
</BODY>
</HTML>